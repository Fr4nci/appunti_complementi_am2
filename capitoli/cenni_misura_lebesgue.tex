\chapter{Cenni alla misura di Lebesgue}

In questo capitolo affronteremo il concetto di misura e daremo alcuni accenni all'impostazione teorica data da Lebesgue nello sviluppo
del suo concetto di misura. Alcuni approfondimenti inseriti sono stati presi da \cite{rudin}, tuttavia per una trattazione più accurata e completa rimando a \cite{measure_theory}.

\section{La misura esterna}
Vogliamo adesso determinare una funzione di insiemi $m_n: \mathcal{P}(\mathbb{R}^n) \to [0; +\infty]$ che rappresenta il nostro concetto intuitivo di \emph{volume} dell'insieme, detto \emph{misura dell'insieme}. \\
L'intuizione ci porta a pensare che questa funzione goda delle seguenti proprietà:
\begin{enumerate}[label=\protect\circled{\arabic*}]
	\item $m_n(\emptyset) = 0$
	\item Se $A, B \subseteq X$ tali che $A \subseteq B \implies m_n(A) \leq m_n(B)$
	\item Se $A, B \subseteq X$ tali che $A \cap B = \emptyset \implies m_n(A \cup B) = m_n(A) + m_n(B)$
\end{enumerate}
\begin{definition}[misura di un intervallo e di un $n-$intervallo]
	Per ogni intervallo $I \subseteq \mathbb{R}$ limitato definiamo
	$$
	\mathit{l}(I) = \sup{I} - \inf{I}.
	$$
	Sia adesso $I_1 \times \ldots \times I_n \subseteq \mathbb{R}^n$ definiamo
	$$
		v_n \left( \varprod_{i=1}^n I_i \right) = \prod_{i=1}^n \mathit{l}(I_i) 
	$$
\end{definition}
\begin{definition}[misura di Lebesgue di un insieme $E$]
	Sia $E \subseteq \mathbb{R}^n$, definiamo la misura di Lebesgue di $E$ come
	\begin{equation}
		m_n(E) = \inf \left\{ \sum_{i=1}^{+\infty} v_n(J_i) : E \subseteq \bigcup_{i=1}^{+\infty} J_i \text{ e } J_i \subseteq \mathbb{R}^n \text{ è un } n\text{-intervallo} \right\}
		\label{eq:def_lebesgue}
	\end{equation}
\end{definition}
\begin{remark}
	Con un procedimento abbastanza simile a come abbiamo fatto per la misura di Peano-Jordan, approssimiamo un insieme $E$ tramite degli $n-$intervalli dall'esterno. La sostanziale differenza, per come stiamo introducendo la misura di Lebesgue, è che stiamo approssimando solamente "da fuori".
	In questa maniera possiamo misurare una classe di insiemi più ampia rispetto a quella della misura di Peano-Jordan, in cui si richiedeva che la misura approssimata "da dentro" coincideva con la misura approssimata "da fuori".
\end{remark}
Come vedremo fra un po', esistono degli insiemi che non sono misurabili per Lebesgue; dunque per ogni sottoinsieme di $X$ non è possibile definire una misura $m_n$ (non su tutti gli insiemi essa è additiva come richiesto, dunque non è una misura). \\ Ci basta, tuttavia, definire una misura \emph{esterna}, ovvero
una funzione che stima il volume di un qualunque insieme $E$ attraverso una collezione di insiemi che ricopre dall'esterno il nostro insieme. In questa maniera è possibile definire una funzione d'insieme definita per ogni insieme, tuttavia non rispetta la proprietà di additività numerabile che noi vogliamo per effettuare operazioni come i limiti: tramite 
il teorema di Caratheodory si può tuttavia mostrare che, presa una misura esterna $\mu^*$, esiste uno spazio di misura in cui la misura coincide con quella esterna. \\
Successivamente, dovremo cercare un criterio con cui stabilire se un insieme $E$ è misurabile o meno.
\begin{definition}
	Diremo che $\mu^*: \mathcal{P}(X) \mapsto [0; +\infty]$ è una misura esterna se
	\begin{enumerate}[label=\protect\circled{\arabic*}]
		\item $\mu^*(\emptyset) = 0$;
		\item $\mu^*(E) \leq \sum\limits_{i=1}^{+\infty} \mu^*(E_i)$ se $E \subseteq \bigcup\limits_{i=1}^{+\infty} E_i$
	\end{enumerate}
\end{definition}
\begin{prop}[monotonia della misura esterna]
	Se $\mu^*$ è una misura esterna allora
	$$
	A \subseteq B \implies \mu^*(A) \leq \mu^*(B)
	$$
	\label{prop:monotonia}
\end{prop}
\begin{proof}
	Consideriamo $E = A$ e il seguente insieme
	\begin{align*}
	E_j = \begin{cases} B & j=1 \\ \emptyset & j \geq 2	\end{cases}
	\end{align*}
	osserviamo allora che $E \subseteq \bigcup\limits_{i=1}^{+\infty} E_i$ allora
	$$
	\mu^*(E) = \mu^*(A) \stackrel{\text{per la \circled{2}}}{\leq} \sum_{j=1}^{+\infty} \mu^*(E_j) = \mu^*(E_1) = \mu^*(B)
	$$
	ovvero
	$$
	\mu^*(A) \leq \mu^*(B)
	$$
\end{proof}
\begin{prop}[subadditività finita]
	Le misure esterne sono finitamente subadditive, ovvero preso $E_1, \ldots, E_k$ avremo che 
	$$
	\mu^* \left( \bigcup_{i=1}^{k} E_i \right) \leq \sum_{i=1}^k \mu^*(E_i)
	$$
	\label{prop:sub_finita}
\end{prop}
\begin{proof}
	Siano $E_1, \ldots, E_k \subseteq \mathbb{R}^n$. Imponendo che $\forall j > k, E_j = \emptyset$, allora
	$$
	\forall E \subseteq \bigcup_{i=1}^{+\infty} E_i, \mu^*(E) \leq \sum_{i=1}^{+\infty} \mu^*(E_i) = \sum\limits_{i=1}^{k} \mu^*(E_i) + \sum\limits_{i=k+1}^{+\infty} \mu^*(\emptyset) = \sum\limits_{i=1}^k \mu^*(E_i) \implies \mu^*(E) \leq \sum_{i=1}^k \mu^*(E_i)
	$$
	ma allora, siccome abbiamo banalmente che $\bigcup\limits_{i=1}^{k} E_i \subseteq \bigcup\limits_{i=1}^k E_i$, allora
	$$
	\mu^* \left( \bigcup_{i=1}^k E_i \right) \leq \sum_{i=1}^k \mu^*(E_i)
	$$
\end{proof}
Vogliamo adesso mostrare che la funzione d'insieme $m_n$ da noi definita è effettivamente una misura esterna, dunque è un buon punto di partenza per poter definire una misura che possieda le proprietà che abbiamo enunciato all'inizio di questo capitolo, siccome il teorema di 
Caratheodory ci assicura di poter trovare uno spazio di misura in cui la misura esterna $\mu^*$ è effettivamente una misura (ovvero è additiva su ogni insieme dello sapzio e non subadditiva).
\begin{prop}[misura di Lebesgue è una misura esterna]
	$m_n: \mathcal{P}(X) \to [0; +\infty]$ è una misura esterna
	\label{prop:lebesgue_mis_esterna}
\end{prop}
\begin{proof}
	La dimostrazione consiste nel mostrare che $m_n: \mathcal{P}(X) \mapsto [0; +\infty]$ gode delle proprietà della misura esterna. \\
	La \circled{1} segue banalmente, siccome l'$n-$intervallo nullo è un ricoprimento dell'insieme nullo, dunque $m_n(\emptyset) = 0$.
	Per la \circled{2}, supponiamo naturalmente che $\sum\limits_{i=1}^{+\infty} m_n(E_i) < +\infty$ (altrimenti è banale) e prendiamo un insieme $E \subseteq \bigcup\limits_{i=1}^{+\infty} E_i$, osservando che $\forall i \in \mathbb{N}, E_i \subseteq \bigcup\limits_{k=1}^{+\infty} I_{k}^{(i)}$, pertanto
	$$
		E \subseteq \bigcup_{i=1}^{+\infty} \bigcup_{k=1}^{+\infty} I_k^{(i)}
	$$
	e questo vale per ogni ricoprimento di $\bigcup\limits_{i=1}^{+\infty} E_i$, dunque anche per quello che "fornisce" la misura di $\bigcup\limits_{i=1}^{+\infty} E_i$
	$$
		m_n(E) \leq \inf \left\{\sum_{i=1} l(E_i) \right\} = m_n \left( \bigcup_{i=1}^{+\infty} E_i \right)
	$$
	resta da mostrare che $m_n( \bigcup\limits_{i=1}^{+\infty} E_i ) \leq \sum\limits_{i=1}^{+\infty} m_n(E_i)$ . Questo può essere fatto fissando $\varepsilon > 0$ e osservando che $\forall i \in \mathbb{N}, \exists \bigcup\limits_{k=1}^{+\infty} I_{i}^{(k)} \supseteq E_i : \sum\limits_{k=1}^{+\infty} l(I_i^{(k)}) < m_n(E_i) + \frac{\varepsilon}{2^{i+1}}$, dunque
	$$
	m_n \left( \bigcup_{i=1}^{+\infty} E_i \right) \leq \sum_{i=1}^{+\infty} \sum_{k=1}^{+\infty} l(I_{i}^{(k)}) < \sum_{i=1}^{+\infty} (m_n(E_i) + \frac{\varepsilon}{2^{i+1}}) = \varepsilon + \sum_{i=1}^{+\infty} m_n(E_i)
	$$
	e, siccome $\varepsilon$ era arbitrario, otteniamo la tesi facendo il limite.
\end{proof}
\begin{definition}[insieme misurabile secondo Lebesgue]
	Diremo che $A \subseteq X$ è misurabile secondo Lebesgue se
	$$
	\forall S \subseteq X \implies m_n(S) = m_n(A \cap S) + m_n(S \setminus A)
	$$
	\label{def:mis_lebesgue}
\end{definition}
Per ogni insieme $X$ definiamo con $\mathfrak{M}(X)$ la classe di tutti gli insiemi misurabili secondo Lebesgue.
\begin{definition}[$\sigma-$algebra]
	Diremo che $\mathcal{F} \subseteq \mathcal{P}(X)$ è una $\sigma-$algebra se valgono
	\begin{enumerate}[label=\protect\circled{\arabic*}]
		\item $\emptyset, X \in \mathcal{F}$;
		\item $A \in \mathcal{F} \implies (X \setminus A) \in \mathcal{F}$
		\item $\{ A_j : j \geq 1 \} \subseteq \mathcal{F} \implies \bigcup\limits_{i=1}^{+\infty} A_i \in \mathcal{F}$
	\end{enumerate}
\end{definition}
\begin{definition}[misura]
	Diremo che $\mu: \mathcal{F} \mapsto [0; +\infty]$ è una misura se
	\begin{enumerate}[label=\protect\circled{\arabic*}]
		\item $\mathcal{F}$ è una $\sigma-$algebra;
		\item $\mu(\emptyset) = 0$;
		\item Se $( \{A_i : i \geq 1 \} \subseteq \mathcal{F}) \wedge (\forall i \neq j, A_i \cap A_j = \emptyset$) allora
		$$
			\mu \left( \bigcup_{i=1}^{+\infty} A_i \right) = \sum_{i=1}^{+\infty} \mu(A_i)
		$$
	\end{enumerate}
\end{definition}
\begin{theorem}[teorema di Caratheodory]
	La classe dei misurabili $\mathfrak{M}(X)$ è una $\sigma-$algebra e $m_n:\mathfrak{M}(X) \to [0; +\infty]$ è una misura
\end{theorem}
Diremo allora che $m_n: \mathfrak{M}(X) \to [0; +\infty]$ è la misura di Lebesgue su $X$. Per lo più noi lavoreremo supponendo che $X=\mathbb{R}^n$.
\begin{prop}
	La misura $m_n: \mathfrak{M}(X) \to [0; +\infty]$ è finitamente additiva
\end{prop}
\begin{proof}
La dimostrazione è equivalente a quella della proposizione~\ref{prop:sub_finita} sostituendo opportunamente alle minorazione le eguaglianze.
\end{proof}
\begin{remark}
Ammettendo l'assioma della scelta è possibile mostrare che esistono degli insiemi che non sono misurabili (come ampiamente detto in precedenza). L'esempio più famoso è
l'insieme di Vitali, che si può costruire dentro un qualunque insieme di misura positiva $E \in \mathfrak{M}(\mathbb{R}^n)$. Dalla definizione di misurabilità allora $\exists S_0 \subseteq \mathbb{R}^n$
tale che 
$$
m_n(S_0) \leq m_n(S_0 \cap E) + m_n(S_0 \setminus E)
$$
dunqque si perderebbe la $\sigma-$additività su insiemi disgiunti.
\end{remark}
\section{Insiemi trascurabili}
\begin{definition}[insiemi trascurabili]
	Diremo che $Z \subseteq \mathbb{R}^n$ ha misura nulla oppure che è trascurabile se $m_n(Z) = 0$
\end{definition}
\begin{exercise}
	Mostrare che un punto $x \in \mathbb{R}^n$ ha misura nulla
\end{exercise}
\begin{proof}[Svolgimento]
	Sia $x \in \mathbb{R}^n$ e consideriamo un $n-$intervallo $\varprod\limits_{i=1}^n I_i$ dove $I_i = (x_i - \frac{\varepsilon}{2}, x_i + \frac{\varepsilon}{2})$ ($x_i$ rappresenta la $i-$esima componente del punto $x$), dunque rappresenta un cubo di \emph{volume} pari a $\varepsilon^n$ per $i \in \{1, \ldots, n \}$ con $\varepsilon > 0$. Allora possiamo osservare che
	$$
	\{ x \} \subseteq \bigcup_{i=1}^{+\infty} J_i
	$$
	dove
	\begin{align*}
		J_i = \begin{cases}
			\varprod\limits_{i=1}^n (x_i - \frac{\varepsilon}{2}, x_i + \frac{\varepsilon}{2}) \\
			\emptyset
		\end{cases}
	\end{align*}
	ma allora
	$$
	m_n(\{ x \}) \subseteq \bigcup_{i=1}^{+\infty} v_n(J_i) = \varepsilon^n
	$$
	ma allora, siccome $\varepsilon > 0$ è un valore arbitrario, possiamo farne il limite per $\varepsilon \to 0$, dunque $m_n(\{ x \}) = 0$.
\end{proof}
\begin{prop}
	Se $Z \subseteq \mathbb{R}^n$ è numerabile, allora
	$$
		m_n(Z) = 0
	$$
\end{prop}
\begin{remark}
	Non tutti gli insiemi a misura nulla sono numerabili: un esempio è l'insieme di Cantor.
\end{remark}
\begin{proof}
	Se $Z$ è numerabile allora
	$$
		Z = \bigcup_{i=1}^{+\infty} \{ x_i \}
	$$
	dove $x_i: \mathbb{N} \to Z$ dunque
	$$
	m_n(Z) \leq \sum_{i=1}^{+\infty} m_n(\{ x_i \}) = 0 \implies m_n(Z) = 0
	$$
\end{proof}
\begin{cor}
	$\mathbb{Q}^n$ è un insieme trascurabile
\end{cor}
\begin{proof}
$\mathbb{Q}^n \cong \mathbb{N}$ dunque $m_n(\mathbb{Q}^n) = 0$
\end{proof}
\begin{cor}
	Gli insiemi a misura nulla sono misurabili per Lebesgue.
	\label{cor:mis_nulla_misur}
\end{cor}
\begin{proof}
In virtù della definizione~\ref{def:mis_lebesgue} dobbiamo verificare che, preso $Z$ insieme trascurabile, allora
$$
\forall S \subseteq \mathbb{R}^n, m_n(S) = m_n(S \setminus Z) + m_n(S \cap Z)
$$
Ora osserviamo che, siccome $S = (S \setminus Z) \cup (S \cap Z)$, avremo per la subadditività finita (di cui gode $m_n$ siccome nella proposizione~\ref{prop:lebesgue_mis_esterna} abbiamo mostrare che è una misura esterna)
che
$$
m_n(S) \leq m_n(S \setminus Z) \cup (S \cap Z)
$$
Per la disuguaglianza opposta osserviamo che
\begin{align*}
m_n(S) \geq m_n(S \setminus Z) \text{ e } m_n(Z) \geq m_n(S \cap Z)
\end{align*}
per monotonia della misura esterna (proposizione~\ref{prop:monotonia}), ma siccome $0=m_n(Z) \geq m_n(S \cap Z) \implies m_n(S \cap Z) = 0$ allora
$$
m_n(S) \geq m_n(S \setminus Z) = m_n(S \setminus Z) + m_n(S \cap Z) \implies m_n(S) \geq m_n(S \setminus Z) + m_n(S \cap Z)
$$
dunque $m_n(S) = m_n(S \setminus Z) + m_n(S \cap Z)$, ovvero la tesi.
\end{proof}
\begin{theorem}[gli aperti sono misurabili]
	Tutti gli aperti di $\mathbb{R}^n$ sono misurabili secondo Lebesgue
\end{theorem}
Per dimostrare questo teorema abbiamo bisogno del seguente lemma:
\begin{lemma}
Ogni aperto di $\mathbb{R}^n$ è unione numerabile di $n-$intervalli a due a due disgiunti
\end{lemma}
\begin{proof}
	Sia $A \subseteq \mathbb{R}^n$ aperto non vuoto. Allora possiamo considerare la famiglia degli $n-$intervalli $I \subseteq A$ ad estremi razionali, ovvero:
	$$\mathcal{V} = \{I = \prod_{i=1}^n (a_i, b_i] : I \subseteq A, a_i, b_i \in \mathbb{Q} \, \, \forall i \in \{1, \ldots, n\} \}$$
	Siccome ogni $n-$intervallo all'interno di $\mathcal{V}$ può essere messo in corrispondenza biunivoca con la $2n-$upla $(a_1, \ldots, a_n, b_1, \ldots, b_n) \in \mathbb{Q}^{2n}$ che è un insieme numerabile, allora anche $\mathcal{V}$ è un insieme numerabile. E' banale l'inclusione $\bigcup\limits_{I \in A} I \subseteq A$ (per definizione di $\mathcal{V}$), vogliamo
	adesso mostrare che vale anche l'inclusione opposta: sia $x \in A$ e, siccome $A$ è aperto, avremo che 
	$$\forall y \in A, \exists \varepsilon > 0 : \{y = (y_1, \ldots, y_n) \in \mathbb{R}^n : |y_i - x_i| < \varepsilon \, \, \forall i \in \{1, \ldots, n \} \} \subseteq A$$
	Siccome $\mathbb{Q}$ è denso in $\mathbb{R}$ avremo che $\forall i \in \{1, \ldots, n \}, \exists \alpha_i, \beta_i \in \mathbb{Q}$ tali che
	$$
	x_i - \varepsilon < \alpha_i < x_i < \beta_i < x_i + \varepsilon 
	$$
	Dunque avremo che l'$n-$intervallo $I'=\prod\limits_{i=1} (\alpha_i, \beta_i]$ contiene il punto $x$, dunque $x \in \mathcal{V} \implies x \in \bigcup\limits_{I \in \mathcal{V}} I \implies A \subseteq \bigcup_{I \in \mathcal{V}} I$. Concludiamo
	che $A = \bigcup\limits_{i=1} I$. \\
	Mostriamo adesso che possiamo prendere gli $n-$intervalli a due a due disgiunti. Consideriamo $A = \bigcup_{i=i}^{+\infty} I_i$ ma allora, posto $J_i = I_i \setminus \bigcup_{j=1}^{i-1} I_j$, possiamo vedere facilmente che
	$$
	\bigcup_{i=1}^{+\infty} I_i = \bigcup_{i=1}^{+\infty} J_i = A
	$$
\end{proof}
Siamo pronti adesso a dimostrare il teorema:
\begin{proof}[Dimostrazione (del teorema)]
	Sia $A$ un insieme aperto. Per il lemma precedente sappiamo che $A = P = \bigcup_{k=1}^{+\infty} I_i$ dove $I_i$ è un $n-$intervallo, dunque $m_n(P \setminus A) = m_n(\emptyset) = 0$.
	Pertanto $P \setminus A \in \mathfrak{M}(\mathbb{R}^n)$ e $P \in \mathfrak{M}(\mathbb{R}^n)$ siccome unione di $n-$intervalli. 
\end{proof}
\begin{cor}
	Tutti gli insiemi chiusi di $\mathbb{R}^n$ sono misurabili secondo Lebesgue
\end{cor}
\begin{proof}[Dimostrazione (del corollario)]
	Siccome $m_n: \mathfrak{M}(\mathbb{R}^n) \to [0; +\infty]$ allora $\mathfrak{M}(\mathbb{R}^n)$ è una $\sigma-$algebra, dunque se $A \in \mathfrak{M}(\mathbb{R}^n) \implies A^c \in \mathfrak{M}(\mathbb{R}^n)$.
\end{proof}
\begin{cor}
	Tutte le unioni e le intersezioni numerabili di insiemi chiusi o aperti sono ancora misurabili secondo Lebesgue
\end{cor}
\begin{proof}
	Se $\{ B_i : i \geq 1 \} \subseteq \mathfrak{M}(\mathbb{R}^n) \implies \bigcup\limits_{i=1}^{+\infty} B_i \in \mathfrak{M}(\mathbb{R}^n)$ perché $\mathfrak{M}(\mathbb{R}^n)$ è una $\sigma-$algebra, mentre per le intersezioni numerabili abbiamo che se $B_i \in \mathfrak{M}(\mathbb{R}^n) \implies B_i^c \in \mathfrak{M}(\mathbb{R}^n)$ (sempre per le proprietà delle $\sigma-$algebre)
	e, per le leggi di De Morgan, avremo che $\left(\bigcup\limits_{i=1}^{+\infty} B_i^c \right)^c = \bigcap\limits_{i=1}^{+\infty} B_i \in \mathfrak{M}(\mathbb{R}^n)$
\end{proof}
\section{Funzioni misurabili secondo Lebesgue}
Andiamo adesso ad affrontare il concetto di funzione misurabile, il quale ci condurrà, naturalmente, verso il concetto di integrale di Lebesgue
\begin{definition}[funzioni misurabili secondo Lebesgue]
Sia $E \in \mathfrak{M}(\mathbb{R}^n)$ misurabile e $f: E \to \bar{\mathbb{R}}$. Diremo che $f$ è misurabile secondo Lebesgue se $\forall t \in \mathbb{R}$ l'insieme $f^{-1}([-\infty, t)) \in \mathfrak{M}(\mathbb{R}^n)$, ovvero esso è misurabile.
\end{definition}
\begin{remark}(\textbf{Topologia di $[-\infty, \infty]$})
	Ogni aperto di $[-\infty, +\infty]$ è un'unione arbitraria di intervalli che possono essere sia aperti oppure del tipo $[-\infty, t)$ o $(t, +\infty]$.
\end{remark}
\begin{prop}[caratterizzazione delle funzioni misurabili]
	$E \in \mathfrak{M}(\mathbb{R}^n), f: E \to \bar{\mathbb{R}}$ è misurabile se e solo se $\forall O \subseteq \bar{\mathbb{R}}$ aperto di $[-\infty, +\infty]$ abbiamo che $f^{-1}(O) \in M(\mathbb{R}^n)$
\end{prop}
\begin{prop}[le funzioni continue sono misurabili]
	Se $E \in \mathcal{R}^n, f: E \to \mathbb{R}$ è continua, allora è misurabile
\end{prop}
\begin{proof}
	Se $O \subseteq [-\infty, +\infty]$ è un aperto contenuto in $\mathbb{R}$ in realtà è un aperto di $\mathbb{R} \implies f^{-1}(O)$ è aperto in $E$ in virtù del teorema~\ref{thm:teo_cf1}, dunque avremo che $\exists \Omega \subseteq \mathbb{R}^n$ tale che
	$$
	f^{-1}(0) = E \cap \Omega \in \mathfrak{M}(\mathbb{R}^n) \implies f \text{ è misurabile }
	$$
	ovvero la tesi.
\end{proof}
\begin{prop}
	Se $f_n: E \to \bar{\mathbb{R}}$ è una successioni di funzioni misurabili e $f:E \to \bar{\mathbb{R}}$. Se $f_n \stackrel{n \to +\infty}{\to} f \, \, \forall x \in E$ allora $f$ è misurabile
\end{prop}
Prendiamo in causa una funzione che causava molti problemi all'integrale di Riemann, ovvero la funzione di Dirichlet. Al momento, consideriamo una sua \emph{variante} $\chi_k: [0, 1] \to \mathbb{R}$ definita come
\begin{align*}
	\chi_k(x) = \begin{cases}
		1 & \text{ se } x \in \{q_0, \ldots, q_k \} \\
		0 & \text{ se } x \not\in \{q_0, \ldots, q_k \}
	\end{cases}
\end{align*}
allora $\chi_k \stackrel{n \to +\infty}{\to} \chi$, ovvero la funzione di Dirichlet. Grazie alla precedente proposizione siamo in grado di concludere che $\chi$ è misurabile per Lebesgue, ma non per Riemann (sebbene $\forall k, \chi_k$ è Riemann-integrabile).
\begin{exercise}
Mostrare la misurabilità di $\chi$ tramite la definizione di funzione misurabile secondo Lebesgue.
\end{exercise}
\begin{proof}[Svolgimento]
	Osserviamo che $\chi: [0, 1] \mapsto \{0, 1\}$. Mostriamo il seguente lemma
	\begin{lemma}
		Sia $f: A \mapsto B$ e presi $B_1, B_2 \subseteq B$ allora
		$$
			f^{-1}(B_1 \cup B_2) = f^{-1}(B_1) \cup f^{-1}(B_2)
		$$
	\end{lemma}
	\begin{proof}
		Mostriamo che $f^{-1}(B_1 \cup B_2) \subseteq f^{-1}(B_1) \cup f^{-1}(B_2)$: per definizione sappiamo che $f^{-1}(B_1 \cup B_2) = \{x \in A: f(x) \in B_1 \cup B_2 \} \implies f(x) \in B_1 \vee f(x) \in B_2 \implies x \in f^{-1}(B_1) \vee x \in f^{-1}(B_2)$.
		Mostriamo che $f^{-1}(B_1 \cup B_2) \supseteq f^{-1}(B_1) \cup f^{-1}(B_2)$: supponiamo, per assurdo, che $\exists x \in f^{-1}(B_1) \cup f^{-1}(B_2) : x \not\in f^{-1}(B_1 \cup B_2) \implies f(x) \in B_1 \vee f(x) \in B_2$ e $f(x) \not\in B_1 \cup B_2$, il che è un assurdo.
	\end{proof}
	Dunque, in virtù di questo lemma appena mostrato, avremo che
	$$
		\chi^{-1}(\{0, 1\}) = \chi^{-1}(\{0 \}) \cup \chi^{-1}(\{1 \})
	$$
\end{proof}
e abbiamo che $\chi^{-1}({0}) = \mathbb{Q} \cap [0, 1]$ che è un'unione numerabile di punti, ovvero i numeri razionali all'interno di questo intervallo che, in virtù del corollario~\ref{cor:mis_nulla_misur}, è misurabile. \\
L'intervallo restante, invece, sarebbe pari a $[0, 1] \setminus (\mathbb{Q} \cap [0,1])$ che, tuttavia, è misurabile siccome $[0,1]$ è misurabile, $\mathbb{Q} \cap [0,1]$ è misurabile e le differenze sono misurabili secondo Lebesgue per le proprietà delle $\sigma-$algebre.
\begin{prop}
	Se $f, g: E \to \bar{\mathbb{R}}$ sono misurabili, allora
	\begin{enumerate}[label=\protect\circled{\arabic*}]
		\item se $f+g$ è ben definita ovunque su $E$ allora $f+g$ è misurabile;
		\item se $\lambda \in \mathbb{R}$ e $\lambda f$ è ben definita ovunque, allora $\lambda f$ è misurabile;
		\item $E \mapsto \max\{f(x), g(x) \}$ e $E \mapsto \min\{f(x),g(x) \}$ sono misurabili;
		\item se $f_j: E \to \mathbb{R}$ è misurabile $\forall j \in \mathbb{N} \implies x \in E \to \sup\limits_{j \in \mathbb{N}} f_j(x)$ è misurabile.
	\end{enumerate}
	\label{prop:f_g_mis}
\end{prop}
\begin{remark}
	Per una buona costruzione della misura di Lebesgue, è comodo definire le operazioni algebriche in $[0; +\infty]$. Definiamo il prodotto come
	\begin{equation*}
		xy = \begin{cases}
			xy & \text{se } \max\{x, y \} < +\infty \\
			+\infty & \text{se } \max\{x, y \} = +\infty \text{ e } \min\{x, y \} > 0 \\
			0 & \text{se } \max\{x, y \} = +\infty \text{ e } \min\{x, y \} = 0
		\end{cases}
	\end{equation*}
	Il terzo caso, che sembra patologico, si può facilmente interpretare in maniera geometrica: avendo in mente la teoria dell'integrazione, il prodotto fra $0 \cdot +\infty$ corrisponde a quella di un rettangolo illimitato con base di lunghezza infinita e
	altezza nulla, dunque ha area "pari" a 0.
\end{remark}
Introduciamo adesso la nozione di funzione semplice, concetto cardine per lo sviluppo dell'integrale di Lebesgue.
\begin{definition}[funzione semplice]
	$\varphi: E \to \mathbb{R}$ è una funzione semplice se $\varphi(E)=\{\lambda_1, \ldots, \lambda_k \} \subset \mathbb{R}$ dove $\lambda_i \neq \lambda_j \, \, \forall i \neq j \in \{1, \ldots, k \}$ dove
	$\varphi^{-1}(\lambda_i) = A_i \in \mathfrak{M}(\mathbb{R}^n) \, \, \forall i \in \{1, \ldots, k \}$.
\end{definition}
\begin{definition}[funzione caratteristica]
	$$
		\mathbb{1}_{A_i} = \begin{cases} 1 & x \in A_i \\ 0 & x \not\in A_i \end{cases}
	$$
\end{definition}
\begin{remark}
Segue banalmente che
$$
\varphi(x) = \sum_{i=1}^k \lambda_i \mathbb{1}_{A_i} (x)
$$
se $\varphi$ è una funzione semplice, naturalmente per opportuni $\lambda_1, \ldots, \lambda_k$ e $A_1, \ldots, A_k \in \mathfrak{M}(\mathbb{R}^n)$.
\end{remark}
Geometricamente non è difficile intuire che il volume sotto una funzione semplice (che assume valori pari a costanti che dipendono dalla regione di spazio) corrisponde ad un "solido" $n-$dimensionale con altezza $\lambda_j$ con $j \in \{1, \ldots, k \}$ e base pari alla "superficie" (naturalmente il termine usato qua è per rendere intuitiva la trattazione, ma non necessariamente è una superficie) 
del dominio. Nell'ipotesi di $\lambda_j \geq 0 \, \, \forall j \in \{1, \ldots, k \}$ (per non avere problemi con volumi negativi) allora possiamo già definire il concetto di integrale

\begin{definition}
	Sia $\varphi: E \to \mathbb{R}$ una funzione semplice con $\lambda_j \geq 0 \, \, \forall j \in \{1, \ldots, k \}$ definiamo il suo integrale come
	\begin{equation}
		I(\varphi) = \sum_{j=1}^n \lambda_j m_n(A_j)
		\label{def:int_funz_sempl}
	\end{equation}
\end{definition}
\begin{remark}
Si osservi che nella definzione~\ref{def:int_funz_sempl} compare il prodotto $0 \cdot +\infty$ quando $m_n(A_i) = +\infty$ e $\lambda_i = 0$.
\end{remark}
\begin{definition}[integrale di Lebesgue]
	Data $f: E \to [0; +\infty]$ misurabile allora
	$$
		\int_E f(x)dx = \sup\{I(\varphi) : 0 \leq \varphi \leq f \text{ e } \varphi \text{ è semplice } \}
	$$
\end{definition}
Introdurremo le seguenti notazioni per l'integrale di Lebesgue
$$
\int_E f(x)dx = \int_E f(x_1, \ldots, x_n)dx_1, \ldots dx_n = \int_E f = \int_E f(x)dm_n(x) = \int_E fdm_n 
$$
\begin{remark}
Segue subito dalla definizione che se $f, g: E \to [0; +\infty]$ sono misurabili e $f \leq g$ su $E$ allora
$$
\int_E f \leq \int_E g
$$
\end{remark}
\begin{remark}
Se $E \in \mathfrak{M}(\mathbb{R}^n) \implies \mathbb{1}_E$ è misurabile e vale
$$
m_n(E) = \int_{\mathbb{R}^n} \mathbb{1}_E dm_n
$$
\end{remark}
\begin{remark}
Se $\varphi: E \to [0; +\infty]$ è semplice allora $\int\limits_E \varphi dm_n = I(\varphi) = \sum_{i=1}^k \lambda_i m_n(E_i) $
\end{remark}
\begin{prop}
Sia $f: E \to \bar{\mathbb{R}}$ misurabile, allora anche $|f|$ è misurabile
\end{prop}
\begin{proof}
$|f| = f^+ + f^-$ dove $f^{+} = \max\{f, 0 \}$ e $f^{-}=\max\{0, -f \}$. Sappiamo, dalla proposizione~\ref{prop:f_g_mis}, che $\max\{f,0 \}$ e $\max\{-f, 0\}$ sono misurabili (dove abbiamo preso $g(x) = 0$) e la somma di due funzioni misurabili è misurabile.
\end{proof}
\begin{definition}[integrabilità secondo Lebesgue]
	Diremo che $f$ è integrabile secondo Lebesgue se
	$$
	\int_E |f(x)|dx < +\infty
	$$
	e, in tal caso, segue che
	$$
	\int_E f(x)dx = \int_E f^{+}(x)dx - \int_E f^{-}(x)dx
	$$
\end{definition}
\begin{definition}[proprietà quasi ovunque]
	Diremo che una proprietà o un'affermazione $P(x)$, con $x \in A$, vale quasi ovunque su $A$ se l'insieme dei punti
	$$
		Z = \{x \in A: P(x) \text{ è falsa } \}
	$$
	ha misura nulla, ovvero $m_n(Z) = 0$
\end{definition}
\begin{prop}
	Se $f: E \to [0; +\infty]$ misurabile allora
	\begin{enumerate}[label=\protect\circled{\arabic*}]
		\item $\int_E fdm_n = 0 \implies f=0$ quasi ovunque su $E$;
		\item $\int_E fdm_n < +\infty \implies f<+\infty$ quasi ovunque su $E$ 
	\end{enumerate}
\end{prop}
\begin{remark}
	La tesi del punto $\circled{1}$ ci dice che $f$ è quasi ovunque nulla su $E$ o equivalentemente che l'insieme $Z \subseteq E$ dei punti in cui $f$ assume dei valori positivi ha misura nulla, dunque $m_n(Z) = 0$. \\
	La tesi del punto $\circled{2}$ è analoga
\end{remark}
\begin{theorem}
	Siano $f, g: E \to \bar{\mathbb{R}}$ integrabili, ovvero $\int_E |f| dm_n < +\infty$ e $\int_E |g|dm_n < + \infty$, allora
	\begin{enumerate}[label=\protect\circled{\arabic*}]
		\item $\lambda, \tau \in \mathbb{R} \implies \lambda f + \tau g \in \mathbb{R}$ è quasi ovunque ben definita e sommabile. Inoltre
		$\int_E (\lambda f + \tau g) dm_n = \lambda \int_E f dm_n + \tau \int_E g dm_n$
		\item $|\int_E f dm_n| \leq \int_E |f|dm_n$
		\item $f \leq q$ quasi ovunque su $E \implies \int_E f \leq \int_E g$ 
	\end{enumerate}
\end{theorem}
\begin{theorem}[integrale di Riemann $1-$dimensionale con l'integrale di Lebesgue]
	Siano $-\infty \leq a < b \leq +\infty, I \subseteq \mathbb{R}$ intervallo tale che $a = \inf{I}$ e $b=\sup{I}$ e sia $f: I \to \mathbb{R}$ assolutamente integrabile secondo Riemann in senso generalizzato su $I$, ovvero
	$$
	\int_a^b |f(t)|dt < +\infty
	$$
	allora $f: I \to \mathbb{R}$ è integrabile (e quindi misurabile) secondo Lebesgue e
	\begin{equation}
		\int_a^b f(t)dt = \int_I fdm_n
		\label{eq:eqv_leb_riem}
	\end{equation}
\end{theorem}
\begin{remark}
	Osserviamo che l'equazione~\ref{eq:eqv_leb_riem} è il primo procedimento operativo con cui calcolare l'integrale di Lebesgue
\end{remark}
\begin{remark}
	Il teorema include anche il caso particolare in cui $I=[a,b]$.
\end{remark}
\begin{remark}(Esistenza di funzioni integrabili secondo Riemann in senso generalizzato ma non secondo Lebesgue) \\
	La funzione $f(x) = \frac{\sin{x}}{x}$ è integrabile (ma non assolutamente!) secondo Riemann in senso generalizzato nell'intervallo $[1, +\infty]$ ma non per Lebesgue. \\
	Mostriamo che non è integrabile secondo Lebesgue mostrando che
	$$
	\int_1^{+\infty} \Big| \frac{\sin{x}}{x} \Big|dx = +\infty
	$$
	Osserviamo che possiamo "spaccare" il nostro integrale, per linearità rispetto agli ordini di integrazione, fra multipli interi di $\pi$:
	\begin{align*}
	&\int_1^{+\infty} \Big| \frac{\sin{x}}{x} \Big| = \int_1^{\pi} \frac{\sin{x}}{x} + \sum_{k=1}^{+\infty} \int_{k\pi}^{(k+1)\pi} \Big|\frac{\sin{x}}{x} \Big|dx \geq \sum_{k=1}^{+\infty} \int_{k\pi}^{(k+1)\pi} \Big|\frac{\sin{x}}{(k+1)\pi} \Big| = \sum_{k=1}^{+\infty} \frac{1}{(k+1)\pi}\int_{k\pi}^{(k+1)\pi} |\sin{x}|dx = \\
	&=\sum_{k=1}^{+\infty} \frac{1}{k\pi} = \frac{1}{\pi}\sum_{k=1} \frac{1}{k+1} = +\infty
	\end{align*}
	Possiamo anche far vedere che la funzione $\frac{\sin{x}}{x}$ ammette integrale convergente in $(1, +\infty)$, infatti:
	$$
	\int_1^{+\infty} \frac{\sin{x}}{x}dx = \int_1^\pi \frac{\sin{x}}{x}dx + \sum_{i=1}^{+\infty} \int_{k\pi}^{(k+1)\pi} \frac{\sin{x}}{x}dx = \int_1^{\pi} \frac{\sin{x}}{x}dx + \sum_{i=1}^{+\infty} (-1)^k \int_{k\pi}^{(k+1)\pi} \frac{|\sin{x}|}{x}dx
	$$
	dove abbiamo riscritto il nostro integrale come una sommatoria del tipo $\sum\limits_{i=1}^{+\infty} (-1)^k a_k$ dove $a_k = \int\limits_{k\pi}^{(k+1)\pi} \frac{|\sin{x}|}{x}dx$ siccome, per periodicità della funzione $\sin{x}$ avremo che
	\begin{equation*}
		\int_{k\pi}^{(k+1)\pi} \sin{x} = \begin{cases}
			1 & \text{se } k \text{ pari } \\
			-1 & \text{se } k \text{ dispari }
		\end{cases}
	\end{equation*}
	dunque avremo una serie a segni alterni. Tuttavia
	$$
	a_{k+1} = \int_{(k+1)\pi}^{(k+2)\pi} \frac{|\sin{x}|}{x} dx < \int_{(k+1)\pi}^{(k+2)\pi} \frac{|\sin{x}|}{(k+1)\pi} < \int_{k\pi}^{(k+1)\pi} \frac{|\sin{x}|}{x} dx = a_{k+1} < a_k
	$$
	dunque converge per il criterio di Leibniz.
\end{remark}
\begin{theorem}[teorema della convergenza dominata di Lebesgue] \hspace{1cm} \\
	Se $\forall k, \, f_k: E \to \bar{\mathbb{R}}$ sono misurabili e $\exists g: E \to [0; +\infty]$ integrabile tale che $|f_k| \leq g$ e $f_k \stackrel{k \to +\infty}{\to} f$, allora
	$$
	\int_E |f|dm_n < +\infty \text{ (ovvero è integrabile secondo Lebesgue) }
	$$
	e
	\begin{equation}
		\lim_{k \to +\infty} \int_E |f_k - f| dm_n = 0
	\end{equation}
\end{theorem}
\begin{remark}(Scambio del limite con l'integrale) \\
	Prendiamo la tesi del teorema e osserviamo che
	$$
	\lim_{k \to +\infty} \int_E |f_k - f| dm_n = 0 \implies \lim_{k \to +\infty} \int_E f_k dm_n = \int_E f dm_n = \int_E \lim_{k \to +\infty} f_k dm_n
	$$
	ovvero il limite si scambia con l'integrale
\end{remark}
\section{Introduzione agli spazi $\mathcal{L}^p$}
\begin{definition}[spazio vettoriale $\mathcal{L}^p$]
	Sia $1 \leq p < +\infty$, definiamo
	$$
	\mathcal{L}^p(E) = \left\{ f: E \to \mathbb{R} \text{ mis. } : \int_E |f|^p dm_n < +\infty \right\}
	$$
	e osserviamo che è uno spazio normato rispetto alla norma
	$$
	|| f ||_{\mathcal{L}^p(E)} = \left( \int_E |f|^p dm_n \right)^{\frac{1}{p}}
	$$
\end{definition}
In virtù di quanto detto prima, se $|| f ||_{\mathcal{L}^p(E)} = 0 \implies f = 0$ quasi ovunque su $E$. E' possibile dimostrare che, su questi spazi,
\begin{enumerate}[label=\protect\circled{\arabic*}]
	\item $\mathcal{L}^p(E)$ è uno spazio vettoriale di dimensione infinita quindi se $f, g \in \mathcal{L}^p(E), \lambda, \tau \in \mathbb{R} \implies \lambda f + \tau g \in \mathcal{L}^p(E)$ (abbastanza banale)
	\item $|| f + g ||_{\mathcal{L}^p(E)} \leq || f ||_{\mathcal{L}^p(E)} + || g ||_{\mathcal{L}^p(E)}$	(si fa con la disuguaglianza di Holder)
\end{enumerate}
Per rendere completamente $|| \cdot ||_{\mathcal{L}^p(E)}$ una norma possiamo definire una relazione d'equivalenza fra gli elementi dello spazio vettoriale
$$
f \sim g \iff f = g \text{ quasi ovunque su } E
$$
dunque consideriamo $L^p(E) = \sfrac{\mathcal{L}^p(E)}{\sim}$ l'insieme quoziente della relazione, dove $|| f ||_{L^p(E)} = || g ||_{\mathcal{L}^p(E)}$. \\
Osserviamo che $g \sim f$ è ben definita siccome
$$
|| f ||_{L^p(E)} = \left(\int_E |f|^p \right)^{\frac{1}{p}} = \left(\int_E |g|^p \right)^{\frac{1}{p}} = || g ||_{\mathcal{L}^p(E)}
$$
dunque $|| f ||_{L^p(E)} = 0 \implies [f]_{\sim} = 0$. Quindi $|| \cdot ||_{L^p(E)}$ è una norma su $L^p(E)$ ed è completa: il teorema di
convergenza dominata ci assicura che le successioni di Cauchy a valori in questo spazio convergono, dunque
$$
|| f_k - f_m ||_{L^p(E)} \to 0 \implies \exists f \in L^p(E) : || f - f_k ||_{L^p(E)} \to 0 \implies (L^p(E), || \cdot ||_{L^p(E)}) \text{ è uno spazio di Banach}.
$$
Nel caso di $n=2$ possiamo anche definire un prodotto scalare reale $\varphi: L^2(E) \times L^2(E) \to \mathbb{R}$ tale che $(u, v) \mapsto \int_E uv dm_n$, osservando che
la norma indotta dal prodotto scalare coincide con $L^2(E)$ data prima. La completezza di $L^2(E)$ e la presenza di un prodotto scalare rende tale spazio uno spazio di Hilbert.

\section{Sezionamenti di insiemi in $\mathbb{R}^n$}
Argomento su cui ci sofferemeremo parecchio è lo sviluppo di alcuni strumenti con cui facilitare il calcolo della misura degli insiemi. Uno degli strumenti
più potenti è sicuramente il teorema di Tonelli, il quale ci assicura di poter calcolare la misura di un insieme parametrizzando le altre variabili in funzione delle altre. \\
Supponiamo che $\mathbb{R}^n = \mathbb{R}^k \times \mathbb{R}^h$ con $x \in \mathbb{R}^k, y \in \mathbb{R}^h$.
\begin{theorem}[di Tonelli]
	Sia $E \in \mathfrak{M}(\mathbb{R}^n = \mathbb{R}^k \times \mathbb{R}^h)$ e sia $f: E \to [0; +\infty]$ misurabile. Allora abbiamo che
	\begin{enumerate}[label=\protect\circled{\arabic*}]
		\item per quasi ovunque $x \in \mathbb{R}^k$, l'insieme $E_x$ e la funzione $f(x, \cdot): E_x \to [0; +\infty]$ sono misurabili
		\item la funzione $x \mapsto \int\limits_{E_x} f(x, y)dm_h(y)$ è definita quasi ovunque e misurabile
		\item $\int\limits_E f dm_n = \int\limits_{\mathbb{R}^k}(\int\limits_{E_x} f(x, y)dm_h(y))dm_k(x)$ 
	\end{enumerate}
\end{theorem}
\begin{remark}
	Il quasi ovunque all'interno del teorema ci consente di poter andare ad integrare $x \mapsto \int_{E_x} f(x, y)dy$ anche se $\exists Z \subseteq \mathbb{R}^k$ con $m_k(Z) = 0$ ove non è definita. Infatti,
	possiamo definire la funzione uguale a $0$ su $Z$, dando comunque luogo ad una funzione misurabile in $\mathbb{R}^n$ il cui valore è sempre indipendente dalla scelta, siccome l'insieme $Z$ è a misura nulla.
\end{remark}
\begin{remark}
	Il teorema di Tonelli può essere formulato anche invertendo l'ordine di integrazione, ovvero scambiando la $x$ con la $y$. Più in generale il teorema si può formulare con un qualsiasi raggruppamento di coordinate che fattorizzi
	$\mathbb{R}^n = \mathbb{R}^k \times \mathbb{R}^h$.
\end{remark}
\begin{theorem}[di Tonelli "invertito"]
	Sia $E \in \mathfrak{M}(\mathbb{R}^n)$ e sia $f: E \to [0; +\infty]$ misurabile. Allora abbiamo
	\begin{enumerate}[label=\protect\circled{\arabic*}]
		\item per quasi ovunque $y \in \mathbb{R}^h$, $E_y$ e $f(\cdot, y): E_y \to [0; +\infty]$ sono misurabili
		\item la funzione $y \mapsto \int\limits_{E_y} f(x, y)dm_k(x)$ è definita quasi ovunque e misurabile
		\item $\int\limits_E f dm_n = \int\limits_{\mathbb{R}^h} (\int\limits_{E_y} f(x, y) dm_k(x)) dm_h(y)$
	\end{enumerate}
\end{theorem}
\begin{remark}(Scambio dell'ordine di integrazione) \\
Se $f: E \to [0; +\infty]$ è misurabile allora combinando le due versioni del teorema di Tonelli concludiamo che
$$
	\int\limits_E fdm_n = \int\limits_{\mathbb{R}^k} \left( \int\limits_{E_x} f(x,y)dm_h(y) \right)dm_k(x) = \int\limits_{\mathbb{R}^h} \left( \int\limits_{E_y} f(x, y)dm_k(x) \right) dm_h(y)
$$
ovvero la formula di scambio dell'integrazione. \\
Nel caso particolare in cui $E = A \times B$ con $A \in \mathfrak{M}(\mathbb{R}^k)$ e $B \in \mathfrak{M}(\mathbb{R}^h)$ (dunque $E \in \mathfrak{M}(\mathbb{R}^n)$ che andrebbe mostrato, ma lo daremo per buono), allora
$$f: A \times B \to [0; +\infty] \text{ misurabile } \implies \int\limits_{A \times B} fdm_n = \int\limits_A \left(\int\limits_B f(x, y)dy\right)dx = \int\limits_B \left(\int\limits_A f(x, y)dx\right)dy$$ siccome $(A \times B)_x = B \, \, \forall x \in A$ e $(A \times B)_y = A \, \, \forall y \in B$. \\
Nel caso ancora più particolare in cui, oltre alle condizioni di prima, abbiamo che $f: A \times B \to [0; +\infty]$ misurabile con $f(x, y) = g(x)w(y)$ con $g: A \to [0; +\infty]$ e $w: B \to [0;+\infty]$ allora
$$
\int\limits_{A \times B} f(x,y)dm_n = \int\limits_A g(x)dx \int\limits_B w(y)dy
$$
\end{remark}
Andiamo a formulare un teorema simile a quello di Tonelli ma valido per le funzioni integrabili (secondo Lebesgue).
\begin{theorem}[teorema di Fubini]
	Sia $E \in \mathfrak{M}(\mathbb{R}^n)$ e sia $f: E \to \bar{R}$ integrabile. Allora abbiamo che
	\begin{enumerate}[label=\protect\circled{\arabic*}]
		\item per quasi ovunque $x \in \mathbb{R}^k, E_x$ e $f(x, \cdot): E_x \to \bar{R}$ è sommabile;
		\item la funzione $x \mapsto \int_{E_x} f(x, y)dm_h(y)$ è definita quasi ovunque e sommabile;
		\item $\int\limits_E fdm_n = \int_{\mathbb{R}^k} \left( \int_{E_x} f(x, y)dm_h(y) \right) dm_k(x)$ 
	\end{enumerate}
\end{theorem}
\begin{remark}
	Valgono le medesime considerazioni fatte per il teorema di Tonelli: anche in questo caso, è possibile scambiare l'ordine di integrazione
	ed è possibile con le condizioni particolare di prima, ovvero $E=A \times B$ e $f: A \times B \to \bar{R}$ con $f(x, y) = g(x)w(y)$, separare l'integrale come
	$$
	\int_E f(x, y)dm_n = \int_A g(x)dm_k(x) \int_B w(y)dm_h(y)
	$$
	se $f$ è integrabile, $A \in \mathfrak{M}(\mathbb{R}^k)$, $B \in \mathfrak{M}(\mathbb{R}^h)$ e $g: A \to \bar{R}$ e $W: b \to \bar{R}$ misurabili.
\end{remark}
\begin{example}
	Consideriamo una funzione $f(x, y)$ integrabile sul dominio rettangolare $D=(0,1)^2$ ($\iff \int_{(0,1)^2} |f(x, y)|dxdy < +\infty$) con la proprietà che $f(x,y)=-f(y,x)$. Mostrare che
	$\int_{(0,1)^2} f(x,y)dxdy = 0$.
\end{example}
\begin{proof}[Svolgimento]
$$
\int_{(0,1)^2} fdm_2 \stackrel{(0,1)^2 = (0,1) \times (0,1)}{=} \int_0^1 \left( \int_0^1 f(x, y) dy \right)dx = -\int_0^1 \left( \int_0^1 f(y,x) dy \right) dx = - \int_{(0,1)^2} fdm_2 \implies \int_{(0,1)^2} fdm_2 = 0 
$$
\end{proof}
\begin{example}
	Consideriamo la funzione $f(x, y)=\frac{x^2 - y^2}{(x^2 + y^2)^2}$ che soddisfa $f(x, y) = -f(y,x)$. Mostrare che non è integrabile.
\end{example}
\begin{proof}[Svolgimento]
	Non sappiamo ancora se $f$ sia integrabile in $E = (0,1)^2$, ovvero se $\int\limits_E |f|dm_2$ è finito o $+\infty$. Supponiamo per assurdo che lo sia, allora dovrebbe valere lo scambio dell'ordine di integrazione:
	\begin{align*}
	&\int_E f(x, y) = \int_0^1 \left( \int_0^1 \frac{x^2 - y^2}{(x^2 + y^2)^2} dx \right) dy = \int_0^1 \left( \int_0^1 \frac{1}{x^2+y^2} - 2\frac{y^2}{(x^2 + y^2)^2} \right) dy
	\end{align*}
	a questo punto facciamo il cambio di variabile $x = ty \implies dx = ydt$, pertanto
	\begin{align*}
	&\int_0^1 \left( \int_0^1 \frac{1}{x^2+y^2} - 2\frac{y^2}{(x^2 + y^2)^2} \right) dy = \int_0^1 \left( \int_0^{\frac{1}{y}} \frac{1}{y^2(1+t^2)} - 2\frac{y^2}{y^4(1+t^2)} ydt \right)dy = \\
	&=\int_0^1 \frac{1}{y} \left[ \arctan{\frac{1}{y}} - 2 \int_0^1 \frac{1}{(1+t^2)}dt \right]dy
	\end{align*}
	Studiamo il secondo termine:
	$$
	\int_0^{\frac{1}{y}} \frac{1}{(1+t^2)^2} dt = \int_0^{\frac{1}{y}} \frac{1}{(1+t^2)}dt - \int_0^{\frac{1}{y}} \frac{t^2}{(1+t^2)^2} dt = \arctan{\frac{1}{y}} - \int_0^{\frac{1}{y}} \frac{t^2}{(1+t^2)^2}dt
	$$
	dunque
	$$
	\int_0^{\frac{1}{y}} \frac{t^2}{(1+t^2)^2} = \int_0^{\frac{1}{y}} \frac{t}{2}(\frac{(1+t^2)^{-1}}{(-1)})dt = \frac{t}{2(1+t^2)}|_b^0 + \int_0^{\frac{1}{y}} \frac{1}{2} \frac{1}{1+t^2}dt = -\frac{\frac{1}{y}}{(1+\frac{1}{y^2})} + \frac{1}{2}\arctan{\frac{1}{y}}
	$$
	dunque
	$$
	\int_E fdm_2 = - \int_0^1 \frac{1}{1+y^2}dy = - \int_0^1 \frac{1}{1+y^2}dy = - \frac{\pi}{4}.
	$$
	Ora osserviamo che, sezionando rispetto a $y$ costante prima, abbiamo che
	\begin{align*}
	&\int_0^1 \left( \int_0^1 \frac{x^2-y^2}{(x^2 + y^2)^2}dy \right)dx \stackrel{\text{raccolgo un } -}{=} - \int_0^1 \left( \int_0^1 \frac{y^2 - x^2}{(x^2 + y^2)^2} dy \right)dx \stackrel{\text{usiamo l'ip. } f(x,y)=-f(y,x)}{=} \\
	&= -\int_0^1 \left(\int_0^1 \frac{x^2-y^2}{(x^2 + y^2)^2} dx \right)dy = - \int_E fdm_2 = \frac{\pi}{4} 
	\end{align*}
	Avevamo supposto che $f$ fosse integrabile, ma questo porta ad un assurdo con il teorema di Fubini; pertanto concludiamo che la nostra funzione non fosse integrabile secondo Lebesgue.
\end{proof}
\begin{exercise}
	Calcolare la misura di $E=\{(x, y) \in \mathbb{R}^2: 0 < x \leq 1, 0 < |y| < \frac{1}{\sqrt{x}} \}$
\end{exercise}
\begin{proof}[Svolgimento]
	L'insieme $E$ è misurabile in quanto è l'unione di un insieme aperto con l'insieme $S=\{(x, y) \in \mathbb{R}^2 : x=1, |y| < 1 \} = \{1\} \times (-1, 1)$ che ha misura nulla. \\
	$$
	m_2(E) = \int_{\mathbb{R}} m_1(E_x)dx = \int_0^1 m_1\left( \left(-\frac{1}{\sqrt{x}}, \frac{1}{\sqrt{x}} \right) \right)dx = 2 \int_0^1 \frac{1}{\sqrt{x}}dx = 4\sqrt{x}\Bigg|^{x=1}_{x=0} = 4
	$$
	dove abbiamo applicato il teorema di Tonelli alla funzione caratteristica $\mathbb{1}_E$, non negativa e misurabile. \\
	Possiamo, pertanto, anche scambiare l'ordine di integrazione osservando che $|y| < \frac{1}{\sqrt{x}} \implies x < \frac{1}{y^2}$: tuttavia devono essere vere contemporaneamente le due disuguaglianze $0 < x \leq 1$ e $0 < x < \frac{1}{y^2} \implies 0 < x < \min\{1, \frac{1}{y^2}\}$. Dunque
	\begin{align*}
	&m_2(E) = \int_{\mathbb{R}^2} \mathbb{1}_E dm_2 = \int_\mathbb{R} \left( \int_\mathbb{R} \mathbb{1}_E(x,y)dx \right)dy = \int_\mathbb{R} m_1(E_y)dy = \\
	&=\int_{\mathbb{R}} m_1 \left( \left\{x \in (0, 1) : |y| < \frac{1}{\sqrt{x}} \right\} \right)dy = 2 \int_0^{+\infty} m_1 \left( \left\{x \in (0,1) : 0 < x < \frac{1}{y^2} \right\} \right)dy = 2 \int_0^{+\infty} \left( \int_0^{\min\{1, \frac{1}{y^2}\}} \mathbb{1}_E dx \right)dy = \\
	&=2 \int_0^1 \left( \int_0^1 \mathbb{1}_E dx \right)dy + 2\int_1^{+\infty} \left( \int_0^{\frac{1}{y^2}} \mathbb{1}_E dx \right)dy = 2 + 2\int_1^{+\infty} \frac{1}{y^2}dy = 2 + 2 = 4
	\end{align*}
	Dunque da questo esercizio capiamo bene che spesso sono conveniente alcuni sezionamenti rispetto ad altri
\end{proof}
\begin{exercise}
	Consideriamo $f: \Omega \to \mathbb{R}$ dove $\Omega = \{(x, y) \in \mathbb{R}^2 : 1 < x < y < e^2, y > e \}$ e $f(x,y) = \frac{1}{x\log{y}}$. Stabilire se $f$ è integrabile ed, in tal caso, calcolare $\int_\Omega f dm_2$
\end{exercise}
\begin{proof}
	Osserviamo innanzitutto che la funzione $f > 0 \forall (x, y) \in \Omega$, $f$ è continua e quindi anche misurabile in $\Omega$ ed è pertanto ben definito $\int_\Omega \frac{1}{x\log{y}}dxdy$. Possiamo, pertanto, applicare il teorema di Tonelli rispetto ad uno dei possibili sezionamenti:
	$$
	\int_\Omega \frac{1}{x} \frac{1}{\log{y}}dxdy = \int_\mathbb{R} \left( \int_{\Omega_y} \frac{1}{x}\frac{1}{\log{y}} dx \right)dy = \int_e^{e^2} \frac{1}{\log{y}} \left( \int_1^y \frac{1}{y} dx \right) dy = \int_e^{e^2} 1dy = e(e-1)
	$$
	Scambiamo l'ordine di integrazione
	\begin{flalign*}
	&\int_\Omega \frac{1}{x} \frac{1}{\log{y}}dxdy = \int_1^{e^2} \frac{1}{x} \left( \int_{\Omega_x} \frac{1}{\log{y}dy} \right)dx =\int_1^e \frac{1}{x} \left( \int_e^{e^2} \frac{1}{\log{y}}dy \right) dx + \int_e^{e^2} \frac{1}{x} \left( \int_x^{e^2} \frac{1}{\log{y}}dy \right)dx = & \\
	&= \int_e^{e^2} \frac{1}{\log{y}}dy + \int_e^{e^2} \left( \int_x^{e^2} \frac{1}{\log{y}}dx \right) dy
	\end{flalign*}
	tuttavia $\int_e^x \frac{1}{\log{t}}dt$ non ha primitiva esprimibile sotto forma delle note funzioni che conosciamo. 
\end{proof}
\begin{exercise}
	Sia $f: E \to \mathbb{R}$ e $f(x, y, z) = \sqrt{x^2 - z^2}\log{y}$ dove $E = \{(x, y, z) \in \mathbb{R}^3 : 0 \leq z \leq x \leq 1, 0 < y \leq x \}$
\end{exercise}
\begin{proof}[Svolgimento]
	Osserviamo che la funzione $f(x) \leq 0 \forall (x, y, z) \in E$. Questo si può facilmente vedere siccome $0 < y \leq x \leq 1 \implies 0 < y \leq 1$ e possiamo inoltre vedere che $f$ è continua, dunque misurabile. \\
	Per le proposizioni viste in precedenza sappiamo che $f^{-}(x, y, z)$ è ben definita e misurabile $\implies \int\limits_E f^{-}(x, y, z)dx$ è ben definito, dunque possiamo applicarvi il teorema di Tonnelli (ricordiamo infatti che tale teorema è applicabile esclusivamente il nostro dominio è
	scrivibile sotto forma di prodotti cartesiani):
	\begin{align*}
	\int_E f^{-}(x, y, z)dm_3 = \int_0^1 \left( \int_{E_x} f dydz \right) dx = \int_0^1 \left( \int_{E_x} fdydz \right)dx = \int_0^1 \left( \int_{E_x} \sqrt{x^2 - z^2}\log{y}dydz \right)dx
	\end{align*}
	osserviamo che $E_x = \{(y, z) \in \mathbb{R}^2 : 0 \leq z \leq x, 0 < y \leq z \}$, dunque
	$$
	\int_E fdm_3 = \int_0^1 \left( \int_0^x \left( \sqrt{x^2 - z^2} \log{y} dy \right)dz \right)dx = \int_0^1 \left(\int_0^x \left( \sqrt{x^2 - z^2} \int_0^x \log{y} dy \right)dz \right) dx 
	$$
	osserviamo che
	\begin{flalign*}
	\int_0^x \log{y}dy = y\log{y}\Bigg|_{y \to 0^+}^{y=x} - \int_0^x 1dy = x\log{x} - x
	\end{flalign*}
	\begin{flalign*}
		&\int_0^x (x^2 - z^2)^{\frac{1}{2}}dz = x^2 \int_0^1 \sqrt{1-t^2}dt = x^2 \int_0^{\frac{\pi}{2}} \sqrt{1-\sin^2{\theta}}\cos{\theta}d\theta = x^2 \int_0^\frac{\pi}{2} \cos^2{\theta}d\theta = x^2 \int_0^\frac{\pi}{2} \left(\frac{1+\cos{2\theta}}{2} \right)d\theta = & \\ 
		&x^2 \left( \frac{\pi}{4} + \frac{1}{2}\int_0^{\frac{\pi}{2}} \cos{2 \theta}d\theta \right) = x^2 \frac{\pi}{4}
	\end{flalign*}
	dunque
	\begin{align*}
	&\int_E fdm_3 = \int_0^1 (x \log{x} - x) \frac{\pi}{4}x^2 dx = \frac{\pi}{4} \int_0^1 \left( x^3 \log{x} - x^3 \right) dx = \frac{\pi}{4} \left( \frac{x^4}{4} \log{x}\Bigg|_{x \to 0^+}^{x=1} - \int_0^1 \frac{x^3}{4}dx - \frac{1}{4} \right) = \frac{\pi}{4} \left(-\frac{1}{4} - \frac{1}{16} \right) = \\
	&= -\frac{5\pi}{64}
	\end{align*}
\end{proof}
\section{Teorema del cambiamento di variabili}
Come nel caso degli integrali a singola variabile, vogliamo adesso effettuare dei cambi di variabile all'interno degli integrali. Infatti il passaggio a coordinate permette, spesso, di fruire più facilmente di alcune simmetrie
di cui godono certi insiemi oppure certe funzioni (si pensi a voler calcolare il volume occupato da una sfera: in coordinate cartesiane può essere un incubo parametrizzare le variabili, tuttavia potremmo pensare di scrivere le coordinate dei punti $(x, y, z) \mapsto (\rho, \theta, \varphi)$). Per fare ciò abbiamo bisogno di una serie di risultati:
\begin{theorem}
	Sia $v_1, \ldots, v_n \in \mathbb{R}^n$ e sia $L : \mathbb{R}^n \to \mathbb{R}^n, L(x) = \sum_{i=1}^n x_i v_i$. Allora
	\begin{equation}
		m_n(L([0, 1]^n)) = \left| \det \begin{bmatrix} v_1 & \ldots & v_n \end{bmatrix} \right|
	\end{equation}	
\end{theorem}
\begin{remark}
	Naturalmente se $v_1, \ldots, v_n$ sono una base ortonormale di $\mathbb{R}^n$ allora 
	$$
	m_n(L([0,1]^n)) = \left| \det \begin{bmatrix} v_1, \ldots, v_n \end{bmatrix} \right| = 1
	$$
	ovvero le isometrie preservano la misura di Lebesgue. Questo, naturalmente, risulta intuitivamente ovvio dal punto di vista geometrico, siccome l'area di un rettangolo ruotato o traslato sicuramente risulta sempre la stessa.
\end{remark}
\begin{remark}
	Supponendo che $l_1, \ldots, l_n > 0$, allora
	$$
	L([0, l_1] \times \ldots \times [0, l_n]) = \left\{ v = \sum_{i=1}^n t_i v_i : 0 \leq t_i \leq x_i \right\} = \left\{ \sum_{i=1}^n \tau_i l_i v_i :  0 \leq \tau_i \leq 1 \right\} = T([0,1]^n) \text{ dove } T(x)=\sum_{i=1} \tau_i l_i v_i
	$$
	dunque
	\begin{flalign*}
	&m_n(L([0, l_1] \times \ldots \times [0, l_n])) = m_n(T([0,1]^n)) = \left| \det \begin{bmatrix} l_1v_1, l_2v_2, \ldots, l_n v_n \end{bmatrix} \right| = \left| \det \begin{bmatrix} v_1, \ldots, v_n \end{bmatrix} \right| \prod_{i=1}^n l_i = & \\ 
	&\left| \det \begin{bmatrix} v_1, \ldots, v_n \end{bmatrix} \right| m_n([0, l_1] \times \ldots \times [0, l_n])  
	\end{flalign*}
\end{remark}
\begin{definition}[jacobiano]
	Se $f: \Omega \to \mathbb{R}^n, \Omega$ aperto $\subseteq \mathbb{R}^n$ e $f \in C^1(\Omega, \mathbb{R}^n), x \in \Omega$ allora
	$$
	Jf(x) = |\det{Df(x)}|
	$$
	detto jacobiano di $f$ in $x$.
\end{definition}
\begin{remark}
	Sia $L: \mathbb{R}^n \to \mathbb{R}^n, L(e_i) = v_i \, \, \forall i \in \{1, \ldots, n \} \implies A = [v_1, \ldots, v_n] \in \mathbb{R}^n$ è la matrice associata ad $L$ allora
	$$
	DL = A = [v_1, \ldots, v_n]
	$$
	e dunque per l'osservazione precedente avremo che
	$$
	m_n (L([0, l_1] \times \ldots \times [0, l_n])) = \left| \det \begin{bmatrix} v_1, \ldots, v_n \end{bmatrix} \right| l_1 \ldots l_n = DL m_n([0, l_1] \times \ldots \times [0, l_n]) \implies DL = \frac{m_n(L([0, l_1] \times \ldots \times [0, l_n]))}{m_n([0, l_1] \times \ldots \times [0, l_n])}
	$$
	dove in realtà $Q$ può essere sostituito da un qualunque insieme $E \in \mathfrak{M}(\mathbb{R}^n)$ con $m_n(E) > 0$.
\end{remark}
In maniera euristica possiamo dare una traccia di dimostrazione del teorema di cambio di variabile che vogliamo adesso utilizzare. Supponiamo di voler effettuare un cambio di variabili all'interno dell'integrale: la funzione $f(x) \in C^1$ intorno a $x_0$ può
essere approssimata con un'applicazione lineare del tipo
$$
f(x) = f(x_0) + Df(x_0)(x-x_0) \implies f(x_0 + I) \approx f(x_0) + Df(x_0)(I)
$$
ove $I=[0, x_1] \times [0, x_n]$ per $x_1, \ldots, x_n > 0$. Pertanto per quanto visto prima
$$
m_n(f(x_0 + I)) = m_n(Df(x_0)(I)) = Jf(x_0) \prod_{i=1}^n x_i \implies df(x) = Jf(x) dx_1 \ldots dx_n
$$
Per alleggerire l'enunciato del teorema, diamo la definizione di diffeomorfismo che rende un poco più snello l'enunciato del teorema del cambiamento di variabile.
\begin{definition}[diffeomorfismo]
	Diremo che $\varphi: \Omega \to \mathcal{U}$ è un diffeomorfismo se 
	\begin{enumerate}[label=\protect\circled{\arabic*}]
		\item $\varphi$ è invertibile; 
		\item $\varphi \in C^1(\Omega, \mathcal{U})$;
		\item $\varphi^{-1} \in C^1(\mathcal{U}, \Omega)$
	\end{enumerate}
\end{definition}
Possiamo dare due versioni di questo teorema: uno per le funzioni misurabili, un altro per le funzioni integrabili (come per il teorema di Tonelli e di Fubini).
\begin{theorem}[cambio di variabili per funzioni misurabili]
	Sia $E \in \mathfrak{M}(\mathbb{R}^n), f: E \to [0; +\infty]$ misurabile, $\Omega, \mathcal{U} \subseteq \mathbb{R}^n$ aperti, $T: \Omega \to \mathcal{U}$ diffeomorfismo. Allora
	\begin{enumerate}[label=\protect\circled{\arabic*}]
		\item $T^{-1}(E) \in \mathfrak{M}(\mathbb{R}^n)$ e $f \circ T: T^{-1}(E) \to [0; +\infty]$ è misurabile;
		\item $$\int_E f(y)dy = \int_{T^{-1}(E)} f(T(x))JT(x)dx$$
	\end{enumerate}
\end{theorem}
\begin{theorem}[cambio di variabili per funzioni integrabili]
	Sia $E \in \mathfrak{M}(\mathbb{R}^n), f: E \to \bar{\mathbb{R}}$ integrabile secondo Lebesgue, $\Omega, \mathcal{U} \subseteq \mathbb{R}^n$ aperti, $T: \Omega \to \mathcal{U}$ diffeomorfismo. Allora
	\begin{enumerate}[label=\protect\circled{\arabic*}]
		\item $T^{-1}(E) \in \mathfrak{M}(\mathbb{R}^n)$ e $f \circ T: T^{-1}(E) \to [0; +\infty]$ è misurabile;
		\item $$\int_E f(y)dy = \int_{T^{-1}(E)} f(T(x))JT(x)dx$$
	\end{enumerate}
\end{theorem}
Andiamo adesso a discutere dei vari sistemi di coordinate a cui passare per rendere più \emph{handy} il calcolo degli integrali.
\subsection{Coordinate polari}
Per identificare un punto, invece di identificarli tramite la sua ascissa e la sua ordinata, possiamo pensare di individuarli tramite la sua distanza dall'origine e dall'angolo che il segmento che lo congiunge con
l'origine forma con l'asse delle ascisse. Dunque
\begin{align*}
&\begin{cases}
	x = \rho \cos{\varphi} \\
	y = \rho \sin{\varphi}
\end{cases} & &\iff & &(x, y) = T(\rho, \varphi) \\
& & & & &\rho > 0, 0 < \varphi < 2\pi
\end{align*}
dunque potremmo 
\begin{figure}[H]
	\centering
	\begin{tikzpicture}
		% Disegna gli assi cartesiani
		\draw[->] (-0.5, 0) -- (3, 0) node[right] {\(x\)};
		\draw[->] (0, -0.5) -- (0, 3) node[above] {\(y\)};
		
		% Disegna il segmento che rappresenta \rho
		\node[above] at (2, 2) {\((x, y)\)};
		\draw[thick] (0, 0) -- (2, 2) node[midway, above left] {\(\rho\)};
		
		% Disegna l'arco per l'angolo \varphi
		\draw[thick] (1, 0) arc[start angle=0, end angle=45, radius=1cm];
		\node at (1.2, 0.3) {\(\varphi\)};
		
		% Punto iniziale del segmento
		\filldraw (0, 0) circle (1pt);
		\filldraw (2, 2) circle (1pt);
	\end{tikzpicture} 
\end{figure}
osserviamo che il jacobiano di questa trasformazione $T$ che è in funzione delle variabili $(\rho, \varphi)$ sarà pari a
$$
DT(\rho, \varphi) = \det \begin{bmatrix} \cos{\varphi} && -\rho \sin{\theta} \\
	\sin{\varphi} && \rho \cos{\theta}
\end{bmatrix} 
$$
per garantire l'iniettiva della nostra trasformazione, definiamo $T: \mathbb{R}^+ \times (0, 2\pi) \mapsto \mathbb{R}^2 \setminus ([0; +\infty) \times \{0\})$ dunque
\begin{figure}[H]
	\centering
	\begin{tikzpicture}
		% Assi
		\draw[->] (-3, 0) -- (0, 0);
		\draw[->, dashed] (0, 0) -- (3, 0) node[right] {\(x\)};
		\draw[->] (0, -3) -- (0, 3) node[above] {\(y\)};
		% Il segmento che rappresenta \rho
		\node[above] at (2, 2) {\((x, y)\)};
		\draw[thick] (0, 0) -- (2, 2) node[midway, above left] {\(\rho\)};
		
		% Arco fra il segmento e l'asse x
		\draw[thick] (1, 0) arc[start angle=0, end angle=45, radius=1cm];
		\node at (1.2, 0.3) {\(\varphi\)};
		%origine e il punto P
		\filldraw (0, 0) circle (1pt);
		\filldraw (2, 2) circle (1pt);


	\end{tikzpicture}
\end{figure}
e, per quanto riguarda la sua inversa, possiamo vedere che presi $x$ e $y$ possiamo risalire alla $\rho$ tramite la semplice relazione $\rho = \sqrt{x^2 + y^2}$, mentre 
l'angolo $\varphi$, posto $\Omega_0 = \mathbb{R}^2 \setminus ([0; +\infty) \times \{0\})$, può essere ottenuto considerando banalmente la funzione argomento, che si può mostrare essere, posto  $C^{\infty}(\Omega_0)$. \\
\begin{remark}
Ci si chiede, inoltre, se il fatto che $T$ non generi tutto lo spazio possa, in qualche maniera contribuire agli integrali; tuttavia si può mostrare che
$$
m_2(\mathbb{R}^2 \setminus \Omega_0) = 0
$$
questo si può facilmente vedere dal fatto che $\mathbb{R}^2 \setminus \Omega_0 = [0; \infty) \times \{0\}$ che corrisponde ad un insieme che, per come avevamo definito le operazioni algebriche in $[0; +\infty]$, corrisponde ad un insieme a misura nulla. \\
Dunque, il suo contributo all'integrale è nullo.
\end{remark}
Per le coordinate polari, dunque, se $E \subseteq \mathbb{R}^2$ misurabile allora
\begin{equation}
	\int_E f(x)dx = \int_{T^{-1}(E)} f(\rho \cos{\varphi}, \rho \sin{\varphi}) \rho d\rho d\varphi
\end{equation}
\begin{exercise}
	Calcolare $\int\limits_{-\infty}^{+\infty} e^{-t^2} dt$
\end{exercise}
\begin{proof}[Svolgimento]
	La funzione $e^{-x^2}$ è naturalmente integrabile, siccome $\frac{e^{-x^2}}{\frac{1}{x^2}} \stackrel{x \to +\infty}{\to} 0$ per gli ordini di infinito, dunque $e^{-x^2} \ll \frac{1}{x^2} \implies \int_1^{+\infty} e^{-x^2} dx \ll \int_1^{+\infty} \frac{1}{x^2}$ mentre sull'intervallo $[0; 1]$ la funzione è limitata e continua. La parita della funzione garantisce lo stesso per l'intervallo $(-\infty; 0]$. Osserviamo
	adesso che, tramite l'integrabilità, siamo sicuri di poter applicare $Fubini$ siccome l'intervallo $(-\infty; +\infty)$ è sicuramente misurabile in quanto aperto. Osserviamo che, applicando Fubini, su un insieme del tipo $\mathbb{R} \times \mathbb{R}$ allora
	$$
	\int_{-\infty}^{+\infty} e^{-(x^2 + y^2)}dxdy = \int_{-\infty}^{+\infty} e^{-y^2} dy \int_{-\infty}^{+\infty} e^{-x^2} dx = (\int_{-\infty}^{+\infty} e^{-x^2}dx)
	$$
	dunque possiamo studiare direttamente l'integrale in due variabili dove possiamo passare alle coordinate polari. Osserviamo che
	\begin{align*}
	&\int_{\mathbb{R}^2} e^{-x^2 - y^2} dxdy = \int_{0}^{+\infty} \int_{0}^{2\pi} e^{-\rho^2 \cos^2{\varphi} - \rho^2 \sin^2{\varphi}} \rho d\theta d\rho = \int_0^{+\infty} \rho d\rho \int_{0}^{2 \pi} e^{-\rho^2} \rho d\rho = -\pi \int_0^{+\infty} -2 \rho e^{-\rho^2} d\rho = - \pi e^{-\rho^2}\Bigg|^{+\infty}_{0} = \\
	&=0 + \pi = \pi
	\end{align*}
	dunque $\int\limits_{-\infty}^{+\infty} e^{-x^2} dx = \sqrt{\pi}$ 
\end{proof}
\begin{exercise}
	Mostrare che $\int\limits_{(0,1)^2} \frac{|x^2 - y^2|}{(x^2 + y^2)^2}dxdy = +\infty$
\end{exercise}
\begin{proof}
	$$
	\int_{(0,1)^2} \frac{|x^2 - y^2|}{(x^2 + y^2)^2}dxdy \geq \int_{B(0,1) \cap (0,1)^2} \frac{|x^2 - y^2|}{(x^2 + y^2)^2} dxdy = \int_{0}^1 \int_0^{2\pi} \frac{|\cos^2{\varphi} - \sin^2{\varphi}|}{\rho} d\rho d\varphi = \int_0^{1} \frac{1}{\rho} d\rho \int_0^{2\pi} |\cos{\frac{\varphi}{2}}| d\varphi = +\infty
	$$
\end{proof}
\subsection{Volumi dei solidi di rotazione}
Definiamo un solido di rotazione attorno all'asse z come l'insieme misurabile $E \subseteq \mathbb{R}^3$ descritto dal profilo $\rho: [h_1, h_2] \to [0; +\infty)$ continuo tale che abbiamo
$$
E = \{(x, y, z) \in \mathbb{R}^3 : x^2 + y^2 \leq \rho(z), h_1 \leq z \leq h_2 \}
$$
Per misurare tale insieme possiamo usare il teorema di Tonelli banalmente
\begin{align*}
&m_3(E) = \int_E \mathbb{1}_E dm_3 = \int_{h_1}^{h_2} \left( \int_{E_z} dxdy \right) = \int_{h_1}^{h_2} \left( \int_{E_z} \rho d\rho d\varphi \right) = \int_{h_1}^{h_2} \left( \int_0^{\rho(z)} \rho d\rho \int_0^{2\pi} d\varphi \right)dz = \int_{h_1}^{h_2} \pi \rho^2(z) dz \\
&= \pi \int_{h_1}^{h_2} \rho^2(z) dz  
\end{align*}
\begin{example}
Consideriamo un cono retto di altezza $H > 0$ e raggio $R > 0$. Definiamo $\rho(z)$ lineare e tale che $\rho(H) = 0, \rho(0) = R \implies \rho(z) = R - \frac{R}{H}z, \rho: [0, H] \to [0; +\infty)$, pertanto
$$
m_3(C) = \pi \int_0^H \left( R - \frac{R}{H}z \right)^2 dz = \pi R^2 \int_0^H \left(1-\frac{z}{H} \right)dz = \pi R^2 \left[ \left(\frac{z}{H} - 1 \right)^3 - \frac{H}{3} \right]^{z=H}_{z=0} = \frac{\pi}{3} R^2 H
$$
\end{example}
Abbiamo quindi mostrato il seguente teorema:
\begin{theorem}
	Sia $E = \{(x, y, z) \in \mathbb{R}^3 : x^2 + y^2 \leq \rho(z), h_1 \leq z \leq h_2 \}$ (a meno di scambiare una coordinata). Allora
	$$
	m_3(E) = \pi \int_{h_1}^{h_2} \rho^2(z)dz
	$$
\end{theorem}
Adesso cerchiamo di estendere la definizione di coordinate polari a $3$ dimensioni. Vogliamo che, nel caso di $z$ costante, individuare alla vecchia maniera 2-dimensionale. Pertanto una possibile trasformazione può essere la seguente
$$
	T(\rho, \varphi, h) = (\rho \cos{\varphi}, \rho \sin{\varphi}, h) = (x, y, z) \implies \begin{cases} x = \rho \cos{\varphi} \\ y = \rho \sin{\varphi} \\ z = h \end{cases}
$$
\begin{figure}[H]
	\centering
	\tdplotsetmaincoords{60}{110}
	\begin{tikzpicture}[scale=3, tdplot_main_coords]

		% Disegna gli assi cartesiani
		\draw[->] (-1, 0, 0) -- (1, 0, 0) node[right] {\(x\)};
		\draw[->] (0, -1, 0) -- (0, 1, 0) node[above] {\(y\)};
		\draw[->] (0, 0, -1) -- (0, 0, 1) node[above] {\(z\)};

		% Segmento rho nel piano xy
		\draw[dashed] (0, 0, 0) -- (1, 1, 0) node[midway, above right] {\(\rho\)};

		% Altezza h sull'asse z
		% \draw[dashed] (2, 1, 0) -- (2, 1, 2) node[above left] {\(h\)};
		\draw[dashed] (1, 1, 0) -- (1, 1, 1) node[midway, above right] {\(h\)};
		\draw[thick] (0, 0, 0) -- (1, 1, 1);
		
		% Arco per l'angolo phi
		\tdplotdrawarc[thick]{(0,0,0)}{1}{0}{2.4674011}{anchor=north}{$\varphi$}

		% Punto finale
		\filldraw (1, 1, 1) circle (1pt);

	\end{tikzpicture}
\end{figure}
pertanto $T: \mathbb{R}^+ \times (0, 2\pi) \times \mathbb{R} \mapsto (\mathbb{R}^2 \setminus [0; +\infty) \times \{ 0 \}) \times \mathbb{R}$. Dunque
$$
JT(\rho, \varphi, h) = \det \begin{bmatrix}
\cos{\varphi} & -\rho \sin{\varphi} & 0 \\
\sin{\varphi} & \rho \cos{\varphi} &  0
0 & 0 & 1
\end{bmatrix} = \rho
$$
il che naturalmente implica
$$
\int_E f(x, y, z)dxdydz = \int_{T^{-1}(E)} f(\rho \cos{\varphi}, \rho \sin{\varphi}, h) \rho d\rho d\varphi dh
$$
Possiamo adesso pensare di calcolare il volume di rotazione $E$ ottenuto ruotando un insieme $A \subseteq (0, +\infty) \times \mathbb{R}$ attorno all'asse $z$: supponiamo per esempio che
$$
E = \{(\rho, \varphi, h) : (\rho, \varphi) \in A, \varphi \in [0, 2\pi] \}
$$
e calcoliamo la misura di tale insieme
\begin{align*}
&m_3(E) = \int_E dxdydz = \int_{T^{-1}(E)} \rho d\rho d\varphi dh = \int_0^{2\pi} \left( \int_{\Omega_\varphi} \rho d\rho dh \right) d\varphi = 2\pi \int_A \rho d\rho dh
\end{align*}
Introducendo il concetto di baricentro, potremmo pensare di definire una grandezza che misura la distanza \emph{media} dall'asse $z$ che ci consente di calcolare il volume come una sorta di base $\times$ altezza:
$$
m_3(E) = 2 \pi R_b m_2(A) = 2 \pi \int_A \rho d\rho dh \implies R_b = \frac{\int_A \rho d\rho dh}{m_2(A)}
$$
Abbiamo mostrato il seguente teorema
\begin{theorem}[secondo teorema di Guldino]
	$$m_3(A) = 2 \pi R_b m_2(A) $$ dove $R_b$ è la distanza del baricentro rispetto all'asse intorno a cui ruota 
\end{theorem}
\begin{exercise}[Volume del toro]
Individuare il volume di un toro, ottenuto dalla rotazione di una circonferenza con centro a distanza $R > 0$ dall' origine e con raggio $r > 0$ con $R > r$
\end{exercise}
\begin{proof}[Svolgimento]
Cercare di parametrizzare l'integrale non è difficile ma non necessario: abbiamo il secondo teorema di Guldino dalla nostra parte. Il baricentro, in questo caso, sarà sempre $R$ e l'area dell'insieme ruotato sarà invece $\pi r^2$
\begin{figure}
	\centering
	\begin{tikzpicture}
		\begin{axis}[
			view={45}{45}, % Angolo di visualizzazione
			colormap name=violet,
			z buffer=sort,
		]
			\addplot3[
				surf,
				samples=40,
				domain=0:2*pi,
				y domain=0:2*pi,
			] (
				{(2 + cos(deg(y))) * cos(deg(x))},
				{(2 + cos(deg(y))) * sin(deg(x))},
				{sin(deg(y))}
			);
		\end{axis}
	\end{tikzpicture}
\end{figure}
dunque
$$
m_3(T) = 2\pi^2 Rr^2
$$
\end{proof}
\subsection{Invarianza per traslazioni e omogeneità della misura di Lebesgue}
Sia $E \in \mathfrak{M}(\mathbb{R}^n), \lambda \in \mathbb{R} \setminus \{0\}, x \in \mathbb{R}^n \implies$
\begin{enumerate}[label=\protect\circled{\arabic*}]
	\item $m_n(x+E) = m_n(E)$
	\item $m_n(\lambda E) = |\lambda|^n m_n(E)$
\end{enumerate}
dove abbiamo definito
\begin{align*}
&\lambda E = \{\lambda y \in \mathbb{R}^n : y \in E \} \\
&x + E = \{x+y \in \mathbb{R}^n : y \in E \}
\end{align*}
Questo può essere facilmente visto come conseguenza di una banalissima trasformazione delle coordinate per mezzo della funzione
$$
T(y) = x + y \text{ con } JT = 1 \implies \int_T(E) 1dz = \int_{E+x} 1dz = \int_E 1dz \iff \circled{1}
$$
nel caso della traslazione e nel caso della dilatazione poiché
$$
H(y) = \lambda y \text{ con } JH = |\lambda|^n \implies \int_{\lambda E} 1dz = \int_{T(E)} 1dz = |\lambda|^n \int_E 1dz \iff \circled{2}
$$
Proponiamo un esercizio piuttosto complicato, che è un buon esercizio per gli integrali
\begin{exercise}
Provare che $\int_{B(0, 1)} \frac{1}{|x|^\alpha}$ converge $\iff 0 < \alpha < n$. Supporre per ipotesi che $\alpha > 0$
\end{exercise}
\begin{proof}[Svolgimento]
	Vogliamo determinare per quali valori di $\alpha > 0$ il seguente integrale converge:
	$$
	\int_{B(0, 1)} \frac{1}{|x|^\alpha} dx
	$$
	possiamo pensare di definire una funzione del tipo
	$$
	\mathbb{1}_{[0, \frac{1}{|x|^\alpha})}(t) = \begin{cases} 1 & \text{ se } 0 \leq t < \frac{1}{|x|^\alpha} \\
	0 & \text{ se } t \geq \frac{1}{|x|^\alpha}
	\end{cases}
	$$
	ora osserviamo che $0 \leq |x| \leq 1$ e dalla condizione $0 < t < \frac{1}{|x|^\alpha}$ segue che $0 \leq x < \min\{1, \frac{1}{t^{\frac{1}{\alpha}}} \}$, dunque avremo che per $t \in [0; 1], t^{\frac{1}{\alpha}} < 1 \implies \frac{1}{t^{\frac{1}{\alpha}}} \geq 1$ ma $|x| < 1$, pertanto la nostra $\mathbb{1}_{[0; \frac{1}{|x|^\alpha})} = 1$. Per
	$t \geq 1$ avremo invece che $t^{\frac{1}{\alpha}} \geq 1 \implies \frac{1}{t^{\frac{1}{\alpha}}} \leq 1 \implies |x| < \frac{1}{\sqrt{1}{t^{\frac{1}{\alpha}}}}$ 
	\begin{align*}
	&\int_0^1 \left( \int_{B(0,1)} \mathbb{1}_{B \left(0, \frac{1}{t^{\frac{1}{\alpha}}} \right)}(x)dx \right)dt + \int_1^{+\infty} \int_{B(0,1)} \left( \mathbb{1}_{B \left(0, \frac{1}{t^{\frac{1}{\alpha}}} \right)}(x)dx	\right)dt = \\
	&m_n(B(0, 1)) + \int_1^{+\infty} m_n \left(B \left(0, \frac{1}{t^{\frac{1}{\alpha}}} \right) \right) \stackrel{\text{per omogeneità}}{=} m_n(B(0,1)) + m_n(B(0,1)) \int_1^{+\infty} \frac{1}{t^{\frac{n}{\alpha}}} = m_n(B(0,1))(1 + \frac{t^{-\frac{n}{\alpha} + 1}}{1 - \frac{n}{\alpha}}\Bigg|^{+\infty}_{1})
	\end{align*}
	dove quest'ultima espressione converge solamente per $0 < \alpha < n$.
\end{proof}
\begin{exercise}
Provare che $\int\limits_{\mathbb{R}^n \setminus B(0,1)} \frac{1}{|x|^\alpha}dx < +\infty \iff \alpha > n$.
\end{exercise}