\chapter{Integrali curvilinei e potenziali}

In questo capitolo andremo a generalizzare il concetto di integrale di Riemann con il concetto di integrale curvilineo, il quale consente di valutare una funzione muovendosi lungo una qualunque direzione, e il concetto di potenziale, il quale ricopre una grandissima importanza in Fisica.

\section{Curve e integrali curvilinei}

Vogliamo estendere il concetto di integrale di Riemann: il primo passo è definire il concetto di \emph{integrale curvilineo}, ovvero l'integrale dove ci muoviamo lungo una \emph{direzione} data dalla curva $\gamma$. Per fare ciò, dobbiamo però richiedere un certo tipo di regolarità da questa curva per non avere problemi nell'integrazione.
\begin{definition}[curva $C^1$ a tratti]
	Sia $\gamma: [a, b] \to \mathbb{R}^n$. Diremo che $\gamma$ è $C^1$ a tratti se $\exists k \in \mathbb{N} : \exists t_0, \ldots, t_k \in [a, b], a = t_0 < \ldots < t_k = b$ tali che $\gamma \in C^1([t_{j}, t_{j+1}]) \, \forall j \in \{0, \ldots, k-1 \}$ e $\gamma \in C^0([a, b])$.
\end{definition}
Possiamo anche definire la famiglia di curve $C^1$ a tratti su $[a,b]$
\begin{definition}[famiglie delle curve $C^1$ a tratti]
	Indichiamo con $C^1_{\text{tratti}}([a, b], \mathbb{R}^n)$ la famiglia di tutte le curve a tratti su $[a, b]$
\end{definition}
Se vogliamo specificare la suddivisione $a=t_0 < t_1 < \ldots < t_k = b$ per la quale la curva $\gamma \in C^1([t_j, t_{j+1}], \mathbb{R}^n) \, \forall j \in \{1, \ldots, k \}$ 
diremo che la curva $\gamma$ è $C^1$ a tratti rispetto alla suddivisione (o partizione) $a = t_0 < \ldots < t_k = b$. \\
\begin{definition}[lunghezza di una curva $\gamma$] 
	Sia $\gamma : [a,b] \to \mathbb{R}^n$, definiamo la lunghezza di $\gamma$ come
	$$
		\mathit{l}(\gamma) = \sup \left\{ \sum_{j=1}^k |\gamma(t_j)-\gamma(t_{j-1})| : a = t_0 < t_1 < \ldots < t_k = b, \, k \in \mathbb{N}^+ \right\}
	$$
\end{definition}
Consideriamo adesso una curva $\gamma \in C^1_{\text{tratti}}([a, b], \mathbb{R}^n)$ rispetto alla suddivisione $a=t_0 < t_1 < \ldots < t_k = b$ allora definiamo
$$
\int_a^b |\dot{\gamma}(t)|dt = \sum_{j=1}^k \int_{t_{j-1}}^{t_j} |\dot{\gamma}(t)|dt 
$$
e possiamo verificare che l'integrale non dipende dalla suddivisione rispetto la quale $\gamma$ è $C^1$ a tratti, infatti se esistesse un'altra suddivisione $a=\tau_0 < \tau_1 < \ldots < \tau_p = b$ allora
$$
\sum_{i=1}^k \int_{t_{i-1}}^{t_{i}} |\dot{\gamma}(t)|dt = \sum_{i=1}^p \int_{\tau_{i-1}}^{\tau_{i}} |\dot{\gamma}(t)|dt
$$
\begin{theorem}
Se $\gamma \in C^1_{\text{tratti}}([a, b], \mathbb{R}^n)$ allora
$$
\mathit{l}(\gamma) = \int_a^b |\dot{\gamma(t)}|
$$
\end{theorem}
\begin{definition}
	Sia $\gamma \in C^1_{\text{tratti}}([a,b], \mathbb{R}^n)$ e $f: \gamma([a,b]) \to \mathbb{R}$ continua, definiamo l'integrale di lunghezza o l'integrale curvilineo di prima specie di $f$ lungo $\gamma$ come
	$$
		\int_{\gamma} f = \int_a^b f(\gamma(t))|\dot{\gamma}(t)|dt
	$$
\end{definition}
%\begin{tikzpicture}
    % Axes
%    \draw[->] (-0.5, 0, 0) -- (6, 0, 0) node[right] {$x$};
%    \draw[->] (0, -0.5, 0) -- (0, 6, 0) node[above] {$y$};
%    \draw[->] (0, 0, -0.5) -- (0, 0, 5) node[above] {$z$};

    % Surface representing f(x, y)
%    \foreach \x in {0, 0.5, ..., 5} {
%        \foreach \y in {0, 0.5, ..., 5} {
%            \pgfmathsetmacro{\z}{0.1*\x^2 + 0.1*\y^2}
%            \fill[red!10] (\x, \y, 0) -- (\x, \y, \z) -- (\x+0.5, \y, \z) -- (\x+0.5, \y, 0) -- cycle;
%        }
%    }

    % Curve gamma
%    \draw[thick, blue, domain=0:5, smooth, variable=\t] plot ({\t}, {2*sin(\t r)}, {0.1*\t^3 - \t + 1}) node[right] {$\gamma$};

    % Area under the curve f \circ gamma
    %\fill[opacity=0.3, blue!30] plot[domain=0:5, smooth, variable=\t] ({\t}, {2*sin(\t r)}, 0) -- plot[domain=0:5, smooth, variable=\t] ({\t}, {2*sin(\t r)}, {0.1*\t^3 - \t + 1}) -- cycle;

    % Points on gamma
    %\fill[black] (1, {2*sin(1)}, {0.1*1^3 - 1 + 1}) circle (1.5pt) node[below left] {$\gamma(t_1)$};
    %\fill[black] (4, {2*sin(4)}, {0.1*4^3 - 4 + 1}) circle (1.5pt) node[below right] {$\gamma(t_2)$};

    % Indicating the integral
%    \node at (2.5, 2, 4) {$\int_{\gamma} f(x, y, z)\, \mathrm{d}s$};
%\end{tikzpicture}
\begin{theorem}
	Sia $\gamma \in C^1_{\text{tratti}}([a, b], \mathbb{R}^n)$ e $f \in C^1(\gamma([a, b]))$. Allora 
	$$
		\varphi: [c, d] \to [a, b]
	$$
	di classe $C^1$ e bigettiva. Allora $\gamma \circ \varphi \in C^1_{\text{tratti}}([c,d], \mathbb{R}^n)$ e
	$$
		\int_{\gamma} f = \int_{\gamma \circ \varphi} f
	$$
\end{theorem}
\begin{proof}
Siccome $\varphi: [c,d] \to [a,b]$ è bigettiva, allora dev'essere monotona. Facciamo la dimostrazione, senza perdita di generalità, nel caso in cui $\varphi$ è strettamente crescente
e possiamo definire $\tau_i = \varphi^{-1}(t_j)$ (che sarà strettamente crescente a sua volta grazie alla continuità della funzione $\varphi$), dunque
$$
\gamma \circ \varphi \in C^1([\tau_i, \tau_{i+1}], \mathbb{R}^n)
$$
(nel caso di $\varphi$ decrescente allora avevamo che $\gamma \circ \varphi \in C^1([\tau_{i+1}, \tau_{i}], \mathbb{R}^n)$) e la composizione di due funzioni continue è ancora una funzione continua, dunque
$\gamma \circ \varphi \in C^{0}([c, d], \mathbb{R}^n)$ e questo ci porta a concludere che
$$
\gamma \circ \varphi \in C^1_{\text{tratti}}([c, d], \mathbb{R}^n)
$$
Mostriamo adesso la tesi per i singoli intervalli nel caso in cui $\varphi$ è strettamente crescente
$$
\int_{t_i}^{t_{i+1}} f(\gamma(t))|\dot{\gamma}(t)|dt \stackrel{t = \varphi(\tau)}{=} \int_{\varphi^{-1}(t_{i})}^{\varphi^{-1}(t_{i+1})} f((\gamma \circ \varphi)(\tau))|\dot{\gamma}(\varphi(\tau))|\dot{\varphi}(\tau) d\tau
$$
\noindent e osserviamo che, siccome $\varphi$ è strettamente crescente, allora $\dot{\varphi}(\tau) = |\dot{\varphi}(\tau)|$, dunque (con un leggero abuso di notazione nelle variabili di integrazioni e sugli estremi di integrazione)
$$
\int_{\tau_i}^{\tau_{i+1}} f((\gamma \circ \varphi)(\tau))|\dot{\gamma}(\varphi(\tau))| \, |\dot{\varphi}(\tau)| d\tau = \int_{\tau_i}^{\tau_{i+1}} f( (\gamma \circ \varphi)(\tau) ) |\gamma \circ \varphi|'(\tau) d\tau.
$$
Sommando in $j$ otteniamo che
$$
\int_\gamma f = \sum_{i=1}^k \int_{t_i}^{t_{i+1}} f(\gamma(t))|\dot{\gamma}(t)|dt = \sum_{i=1}^l \int_{\tau_i}^{\tau_{i+1}} f((\gamma \circ \varphi)(\tau)) |\gamma \circ \varphi|'(\tau) d\tau = \int_{\gamma \circ \varphi} f 
$$
ovvero la tesi.
\end{proof}
\begin{cor}[lunghezza di un arco]
	Sia $f(x): I \to \mathbb{R}$ con $f \in C^1(I)$ allora la lunghezza dell'arco descritto da $f(x)$ è dato da
	$$
		\int_I \sqrt{1 + f'(x)}dx
	$$
\end{cor}
\begin{proof}
Dal teorema precedente, possiamo considerare la curva $\gamma: I \to \mathbb{R}^2$ tale che $\gamma = (t, f(t)) \, \forall t \in I$ e calcolare la lunghezza della curva con il teorema precedente:
$$
	\mathit{l}(\gamma) = \int_{I} |\dot{\gamma}(t)|dt = \int_I \sqrt{1 + (f'(t))^2} dt
$$
ovvero la tesi.
\end{proof}
\section{Integrali curvilinei su forme differenziali e campi vettoriali}

Abbiamo generalizzato l'integrale di Riemann all'integrale curvilineo come l'integrale di una funzione a valori reali lungo una direzione impartita dalla curva $\gamma$, vogliamo adesso generalizzarlo a funzioni a valori vettoriali. I candidati ideali per fare questo sono le forme differenziali e i campi vettoriali di cui richiediamo una certa regolarità
\begin{definition}[$1$-forma differenziale di classe $C^k$]
Sia $\Omega \subseteq \mathbb{R}^n$ un insieme aperto, allora $$\omega(x) = \sum_{j=1}^n a_j(x)dx_j$$ è una $1$-forma differenziale di classe
$C^k(\Omega)$, ovvero
$$
\omega \in C^k(\Omega, (\mathbb{R}^n)^*) \iff a_j \in C^k(\Omega) \, \forall j \in \{1, \ldots n \}
$$
\end{definition}
Diamo adesso la nozione di \emph{esattezza} di una forma differenziale
\begin{definition}[esattezza di una $1$-forma differenziale]
	Diremo che $\omega$ è esatta se esiste una primitiva $V \in C^1(\Omega)$ tale che
	$$
		dV = \omega
	$$
	ovvero se $\omega = \sum_{j} a_j dx_j$ allora $a_j = \frac{\partial V}{\partial x_j}$ su $\Omega \, \forall j \in \{1, \ldots, n\}$
\end{definition}
Equivalentemente diamo la nozione di \emph{chiusura} di una forma differenziale
\begin{definition}
	Sia $\omega = \sum_{j=1}^n a_j dx_j \in C^k(\Omega, (\mathbb{R}^n)^*)$, ovvero una $1$-forma differenziale di classe $C^k(\Omega)$, allora diremo che
	è chiusa se abbiamo che
	$$
		\frac{\partial a_j}{\partial x_i} - \frac{\partial a_i}{\partial x_j} = 0 \, \forall i, j: 1 \leq i < j \leq n
	$$
\end{definition}
Equivalentemente, possiamo dare delle definizioni che sono "duali" nel caso, però, di campi vettoriali:
\begin{definition}[campo vettoriale di classe $C^k$]
	Sia $\Omega \subseteq \mathbb{R}^n$ un insieme aperto, allora $$F(x)=\sum_{j=1}^n f_j(x)e_j$$ è un campo vettoriale di classe $C^k$, ovvero 
	$$F \in C^k(\Omega, \mathbb{R}^n) \iff f_j \in C^k(\Omega) \, \forall j \in \{1, \ldots, n\} $$
\end{definition}
Nel caso di campi vettoriali la nozione di \emph{esattezza} e di \emph{chiusura} è sostituita dal concetto di \emph{campo conservativo} (che è un concetto che ogni fisico ha incontrato nel corso di Fisica 1
nel caso del moto in campo centrale per esempio) e dal concetto di \emph{campo irrotazionale}
\begin{definition}[campo conservativo]
	Diremo che $F$ è un campo conservativo se esiste un potenziale $V \in C^1(\Omega)$ tale che
	$$
	F = \nabla V
	$$
	ovvero se $F=(f_1, \ldots, f_n)$ e abbiamo che $f_j = \frac{\partial V}{\partial x_j}$ su $\Omega \, \forall j \in \{1, \ldots, n \}$
\end{definition}
\begin{definition}[campo irrotazionale]
	Sia  $\Omega \subseteq \mathbb{R}^n$ aperto e sia $F = \sum_{i=1}^n f_i e_i \in C^k(\Omega, \mathbb{R}^n)$ un campo vettoriale, diremo che $F$ è un campo irrotazionale se
	$$
	\frac{\partial f_i}{\partial x_j} - \frac{\partial f_j}{\partial x_i} = 0 \, \forall i, j: 1 \leq i < j \leq n
	$$
\end{definition}

Possiamo andare a definire il concetto di integrale curvilineo di seconda specie di $\omega$ (oppure di $F$) lungo una curva $\gamma$ come segue
\begin{definition}[integrale curvilineo di seconda specie di $\omega$ lungo una curva $\gamma$]
	Sia $\Omega \subseteq \mathbb{R}^n$, $\omega \in C^0(\Omega, (\mathbb{R}^n)^*)$ una $1$-forma differenziale e sia $\gamma \in C^1_{\text{tratti}}([a,b], \Omega)$ una curva. Definiamo l'integrale curvilineo di seconda specie di 
	$\omega$ lungo una curva $\gamma$ come
	$$
		\int_\gamma \omega = \sum_{i=1}^k \int_{t_{j-1}}^{t_j} \omega(\gamma(t))(\dot{\gamma}(t))dt
	$$
\end{definition}
\begin{definition}[integrale curvilineo di seconda specie di $F$ lungo una curva $\gamma$]
	Sia $\Omega \subseteq \mathbb{R}^n$, $F \in C^0(\Omega, \mathbb{R}^n)$ un campo vettoriale e sia $\gamma \in C^1_{\text{tratti}}([a, b], \Omega)$ una curva. Definiamo l'integrale curvilineo di seconda specie di 
	$F$ lungo una curva $\gamma$ come 
	$$
		\int_\gamma F = \sum_{i=1}^k \int_{t_{j-1}}^{t_j} \innerprod{F(\gamma(t))}{\dot{\gamma}(t)}dt
	$$
\end{definition}
\begin{remark}
Dalla definizione di una forma differenziale sappiamo che
$$
\omega(\gamma(t))(\dot{\gamma}(t)) = \sum_{i=1}^n a_i(\gamma(t))dx_i(\gamma(t)) = \sum_{i=1}^n a_i(\gamma(t))\gamma_i(t) 
$$
\end{remark}

\begin{remark}
Questa "dualità" presente fra campo vettoriale e forme differenziali riflette il fatto che su $\mathbb{R}^n$ siano la stessa cosa, infatti guardando l'insieme $\mathbb{R}^n$ come varietà differenziale con la metrica riemanniana possiamo
far corrispondere univocamente forma differenziale a campo vettoriale.
\end{remark}

Con le forme differenziali (e dunque anche con i campi vettoriali) possiamo giungere ad un risultato equivalente a quello raggiunto
con l'integrale valutato su una composizione di curve, così come avevamo fatto nel caso di funzioni a valori reali
\begin{theorem}[di invarianza]
	Sia $\gamma \in C^1_{\text{tratti}}([a, b], \Omega)$, sia $\omega \in C^0(\Omega, (\mathbb{R}^n)^*)$ e sia $\varphi: [c, d] \to [a, b]$
	di classe $C^1$ e invertibile. Ponendo $\sigma(\varphi)= 1$ se $\varphi$ è strettamente crescente e $\sigma(\varphi)=-1$ se $\varphi$ è strettamente decrescente.
	Allora abbiamo che
	$$
		\int_\gamma \omega = \sigma \int_{\gamma \circ \varphi} \omega
	$$
\end{theorem}
\begin{proof}
La dimostrazione è abbastanza simile a quella fatta nel caso di funzioni a valori reali, infatti osserviamo che
$$
\int_{\gamma} \omega = \sum_{j=1}^k \int_{t_{j-1}}^{t_j} \omega(\gamma(t))(\dot{\gamma}(t))dt \stackrel{t=\varphi(\tau) \atop \tau_j = \varphi^{-1}(t_j)}{=} \sum_{j=1}^k \int_{\tau_{i-1}}^{\tau_{i}} \omega((\gamma \circ \varphi)(\tau))(\dot{\gamma}(\varphi(\tau))(\dot{\varphi}(\tau)))d\tau
$$
Supponiamo che $\varphi$ sia strettamente decrescente, dunque anche $\varphi^{-1}$ è strettamente decrescente, quindi $\tau_j < \tau_{j-1}$ e, conseguentemente, $a = \tau_k < \tau_k-1 < \ldots < \tau_0 = b$ pertanto
\begin{align*}
&\int_\gamma \omega = \sum_{j=1}^k \int_{\tau_{i-1}}^{\tau_{i}} \omega((\gamma \circ \varphi)(\tau))(\dot{\gamma}(\varphi(\tau))(\dot{\varphi}(\tau)))d\tau = \sum_{j=1}^k - \int_{\tau_{i}}^{\tau_{i-1}} \omega((\gamma \circ \varphi)(\tau))(\dot{\gamma}(\varphi(\tau))(\dot{\varphi}(\tau)))d\tau = \\
&= \sigma \sum_{j=1}^k \int_{\tau_{i}}^{\tau_{i-1}} \omega((\gamma \circ \varphi)(\tau))(\dot{\gamma}(\varphi(\tau))(\dot{\varphi}(\tau)))d\tau = \sigma \int_{\gamma \circ \varphi} \omega
\end{align*}
ovvero la tesi. Nel caso in cui $\varphi$ fosse strettamente crescente e, dunque, $\sigma=1$ la sommatoria già dà l'integrale curvilineo della composizione
\end{proof}
\begin{prop}
	Siano $\Omega \subseteq \mathbb{R}^n$ un insieme aperto e $\omega \in C^0(\Omega, (\mathbb{R}^n)^*)$ tale che $\omega$ sia esatta con primitiva $P \in C^1(\Omega)$.
	Allora $\forall \gamma \in C^1_{\text{tratti}}([a, b], \Omega)$ abbiamo che
	$$
		\int_{\gamma} \omega = \int_{\gamma} dP = P(\gamma(b)) - P(\gamma(a))
	$$
	Equivalentemente, nel caso vettoriale, sia sempre $\Omega \subseteq \mathbb{R}^n$ un insieme aperto e sia $F \in C^0(\Omega, \mathbb{R}^n)$ con potenziale $V \in C^1(\Omega)$. Allora $\forall \gamma \in C^1_{\text{tratti}}([a, b], \Omega)$ abbiamo che
	$$
		\int_{\gamma} = \int_{\gamma} \nabla V = V(\gamma(b)) - V(\gamma(a))
	$$
\end{prop}
\begin{proof}
E' quasi un conto siccome
\begin{align*}
	&\int_\gamma \omega = \int_\gamma dP = \sum_{j=1}^k \int_{\gamma_|{[t_{j-1}, t_j]}} dP = \sum_{j=1}^k \int_{t_{j-1}}^{t_j} dP(\gamma(t))(\dot{\gamma}(t))dt = \sum_{j=1}^k \int_{t_{j-1}}^{t_j} \sum_{i=1}^n \frac{\partial P}{\partial x_j}(\gamma(t))\dot{\gamma_j}(t)dt = \\
	&= \sum_{j=1}^k \int_{t_{j-1}}^{t_j} \frac{d}{dt}((P \circ \gamma)(t)) dt = \sum_{j=1}^k (P \circ \gamma)(t_{j}) - (P \circ \gamma)(t_{j-1}) = (P \circ \gamma)(b) - (P \circ \gamma)(a)
\end{align*}
ovvero la tesi. Per quanto riguarda il campo vettoriale, osserviamo che
$$
\int_{\gamma} F = \int_{\gamma} \nabla V = \sum_{j=1}^k \int_{t_{j-1}}^{t_j} \sum_{i=1}^n \frac{\partial V}{\partial x_i}(\gamma(t))\dot{\gamma_i}(t)
$$
e con ragionamenti simili a quanto fatto prima possiamo arrivare alla tesi.
\end{proof}
\begin{cor}
	Siano $\Omega \subseteq \mathbb{R}^n$ un insieme aperto e $\omega \in C^0(\Omega, (\mathbb{R}^n)^*)$ tale che $\omega$ sia esatta. Allora $\forall \gamma \in C^1_{\text{tratti}}([a,b], \Omega)$ chiusa abbiamo che
	$$
		\oint_{\gamma} \omega = 0
	$$
	Equivalentemente, sia sempre $\Omega \subseteq \mathbb{R}^n$ un insieme aperto e $F \in C^0(\Omega, \mathbb{R}^n)$ tale che $F$ sia un campo conservativo. Allora $\forall \gamma \in C^1_{\text{tratti}}([a, b], \Omega)$ chiusa abbiamo che
	$$
		\oint_{\gamma} F = 0
	$$
\end{cor}
\begin{proof}
Applicando la proposizione precedente, se $P$ è una primitiva di $\omega$, sappiamo che
$$
\oint_\gamma \omega = P(\gamma(b)) - P(\gamma(a)) = P(\gamma(a)) - P(\gamma(a)) = 0 
$$
Procediamo allo stesso modo per i campi vettoriali.
\end{proof}
